<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MaxMetric ‚Äî –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –∫–∞—Ç–∞–ª–æ–≥ –∫–∞–Ω–∞–ª–æ–≤ MAX</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0%25' stop-color='%238b5cf6'/%3E%3Cstop offset='100%25' stop-color='%233b82f6'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='32' height='32' rx='8' fill='url(%23g)'/%3E%3Cpolyline points='6,22 12,14 18,18 26,8' fill='none' stroke='white' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Ccircle cx='26' cy='8' r='2' fill='white'/%3E%3C/svg%3E">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f8fafc; --bg2: #ffffff; --bg3: #f1f5f9; --bg4: rgba(0,0,0,0.02);
  --text: #0f172a; --text2: #334155; --text3: #64748b; --text4: #94a3b8;
  --border: #e2e8f0; --border2: rgba(0,0,0,0.06);
  --violet: #8b5cf6; --purple: #7c3aed; --blue: #3b82f6; --cyan: #06b6d4;
  --emerald: #10b981; --amber: #f59e0b; --red: #ef4444; --pink: #ec4899;
  --card-shadow: 0 1px 3px rgba(0,0,0,0.04), 0 1px 2px rgba(0,0,0,0.06);
}
.dark {
  --bg: #08081a; --bg2: rgba(255,255,255,0.03); --bg3: rgba(255,255,255,0.05); --bg4: rgba(255,255,255,0.02);
  --text: #f1f5f9; --text2: #cbd5e1; --text3: #64748b; --text4: #475569;
  --border: rgba(255,255,255,0.06); --border2: rgba(255,255,255,0.03);
  --card-shadow: 0 1px 3px rgba(0,0,0,0.3);
}
* { margin:0; padding:0; box-sizing:border-box; }
html { scroll-behavior: smooth; }
body { font-family:'Inter',system-ui,-apple-system,sans-serif; background:var(--bg); color:var(--text); -webkit-font-smoothing:antialiased; transition:background-color .3s,color .3s; overflow-x:hidden; }
a { text-decoration:none; color:inherit; }
button { cursor:pointer; border:none; background:none; font-family:inherit; }
input,select,textarea { font-family:inherit; }
::-webkit-scrollbar { width:6px; height:6px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:rgba(139,92,246,.3); border-radius:3px; }

/* Animations */
@keyframes fadeIn { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }
@keyframes slideIn { from{opacity:0;transform:translateX(-10px)} to{opacity:1;transform:translateX(0)} }
@keyframes pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05)} }
@keyframes progress { from{width:0} to{width:100%} }
@keyframes shimmer { 0%{background-position:-200% 0} 100%{background-position:200% 0} }
.fade-in { animation:fadeIn .4s ease-out forwards; }
.slide-in { animation:slideIn .3s ease-out forwards; }

/* Layout */
.container { max-width:1280px; margin:0 auto; padding:0 16px; }
@media(min-width:640px) { .container { padding:0 24px; } }

/* Header */
.header { position:sticky; top:0; z-index:50; backdrop-filter:blur(20px); background:rgba(255,255,255,.8); border-bottom:1px solid var(--border); transition:all .3s; }
.dark .header { background:rgba(10,10,26,.8); }
.header-inner { display:flex; align-items:center; justify-content:space-between; height:60px; }
.logo { display:flex; align-items:center; gap:10px; cursor:pointer; }
.logo:hover .logo-icon { transform:scale(1.05); }
.logo-icon { transition:transform .3s; }
.logo-text { font-size:18px; font-weight:800; }
.logo-text span { background:linear-gradient(135deg,#8b5cf6,#3b82f6); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
.logo-sub { font-size:10px; color:var(--text3); margin-top:-2px; display:none; }
@media(min-width:640px) { .logo-sub { display:block; } }
.header-nav { display:none; align-items:center; gap:4px; }
@media(min-width:1024px) { .header-nav { display:flex; } }
.nav-btn { display:flex; align-items:center; gap:6px; padding:8px 12px; border-radius:10px; font-size:13px; color:var(--text3); transition:all .2s; position:relative; }
.nav-btn:hover { color:var(--violet); background:rgba(139,92,246,.05); }
.nav-badge { position:absolute; top:-2px; right:-2px; min-width:16px; height:16px; border-radius:8px; font-size:9px; font-weight:700; display:flex; align-items:center; justify-content:center; color:#fff; padding:0 4px; }
.nav-badge.violet { background:var(--violet); }
.nav-badge.pink { background:var(--pink); }
/* Header search ‚Äî always visible, grows to fill space */
.header-search { flex:1; max-width:480px; margin:0 20px; position:relative; display:flex; }
.header-search input { width:100%; padding:9px 38px 9px 38px; border-radius:12px; background:var(--bg3); border:1px solid var(--border); font-size:13px; color:var(--text); outline:none; transition:all .2s; }
.header-search input:focus { border-color:rgba(139,92,246,.5); box-shadow:0 0 0 3px rgba(139,92,246,.1); background:var(--bg2); }
.header-search input::placeholder { color:var(--text4); }
.header-search .hs-icon { position:absolute; left:11px; top:50%; transform:translateY(-50%); color:var(--text4); pointer-events:none; transition:color .2s; }
.header-search input:focus ~ .hs-icon, .header-search:focus-within .hs-icon { color:var(--violet); }
.header-search .hs-clear { position:absolute; right:10px; top:50%; transform:translateY(-50%); color:var(--text4); padding:2px; border-radius:6px; transition:color .2s; }
.header-search .hs-clear:hover { color:var(--text); }
/* Mobile: shrink search */
@media(max-width:600px) { .header-search { margin:0 10px; max-width:none; } }
.header-actions { display:flex; align-items:center; gap:6px; }
.icon-btn { padding:8px; border-radius:12px; background:var(--bg3); border:1px solid var(--border); color:var(--text3); transition:all .2s; position:relative; display:flex; align-items:center; justify-content:center; }
.icon-btn:hover { color:var(--violet); border-color:rgba(139,92,246,.3); }
.add-btn { display:none; align-items:center; gap:6px; padding:8px 16px; border-radius:12px; background:linear-gradient(135deg,#7c3aed,#3b82f6); color:#fff; font-size:13px; font-weight:600; transition:all .3s; }
@media(min-width:640px) { .add-btn { display:flex; } }
.add-btn:hover { box-shadow:0 8px 25px rgba(139,92,246,.3); transform:scale(1.03); }
.notif-dot { position:absolute; top:-2px; right:-2px; width:16px; height:16px; border-radius:8px; background:var(--red); color:#fff; font-size:9px; font-weight:700; display:flex; align-items:center; justify-content:center; }

/* Notification dropdown */
.notif-dropdown { position:absolute; right:0; top:calc(100% + 8px); width:320px; border-radius:16px; background:var(--bg2); border:1px solid var(--border); box-shadow:0 20px 60px rgba(0,0,0,.15); overflow:hidden; z-index:100; }
.dark .notif-dropdown { background:#12122a; box-shadow:0 20px 60px rgba(0,0,0,.5); }
.notif-header { padding:12px 16px; border-bottom:1px solid var(--border2); display:flex; align-items:center; justify-content:between; }
.notif-item { padding:8px 12px; border-radius:10px; display:flex; gap:10px; transition:background .15s; cursor:pointer; border:none; background:none; font-family:inherit; }
.notif-item:hover { background:var(--bg3); }
.notif-item.unread { background:rgba(139,92,246,.03); }
.dark .notif-item.unread { background:rgba(139,92,246,.05); }

/* Hero */
.hero { position:relative; border-radius:24px; overflow:hidden; margin-bottom:32px; }
.hero-bg { position:absolute; inset:0; background:linear-gradient(135deg,#7c3aed,#6d28d9,#3b82f6); }
.hero-pattern { position:absolute; inset:0; background-image:radial-gradient(rgba(255,255,255,.08) 1px,transparent 1px); background-size:20px 20px; }
.hero-deco1 { position:absolute; top:-80px; right:-80px; width:200px; height:200px; border-radius:50%; background:rgba(255,255,255,.05); filter:blur(40px); }
.hero-deco2 { position:absolute; bottom:-40px; left:-40px; width:150px; height:150px; border-radius:50%; background:rgba(255,255,255,.05); filter:blur(40px); }
.hero-content { position:relative; padding:40px 24px; text-align:center; }
@media(min-width:640px) { .hero-content { padding:56px 40px; } }
.hero-badge { display:inline-flex; align-items:center; gap:6px; padding:4px 12px; border-radius:20px; background:rgba(255,255,255,.1); border:1px solid rgba(255,255,255,.2); font-size:11px; color:rgba(255,255,255,.8); margin-bottom:20px; backdrop-filter:blur(8px); }
.hero h2 { font-size:28px; font-weight:800; color:#fff; margin-bottom:8px; line-height:1.2; }
@media(min-width:640px) { .hero h2 { font-size:40px; } }
.hero h2 span { background:linear-gradient(90deg,#67e8f9,#c4b5fd,#93c5fd); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
.hero p { color:rgba(255,255,255,.6); font-size:14px; margin-bottom:32px; max-width:500px; margin-left:auto; margin-right:auto; }

.hero-tags { display:flex; flex-wrap:wrap; justify-content:center; gap:8px; margin-bottom:24px; }
.hero-tag { padding:6px 14px; border-radius:20px; background:rgba(255,255,255,.1); border:1px solid rgba(255,255,255,.1); color:rgba(255,255,255,.7); font-size:12px; transition:all .2s; cursor:pointer; display:flex; align-items:center; gap:5px; }
.hero-tag:hover { background:rgba(255,255,255,.2); color:#fff; }
.hero-actions { display:flex; flex-wrap:wrap; justify-content:center; gap:10px; }
.hero-add-btn { display:inline-flex; align-items:center; gap:10px; padding:14px 32px; border-radius:16px; font-size:15px; font-weight:700; background:rgba(255,255,255,0.15); color:#fff; border:1px solid rgba(255,255,255,0.3); backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px); transition:all .3s; box-shadow:0 4px 20px rgba(0,0,0,.1); letter-spacing:.2px; }
.hero-add-btn:hover { background:rgba(255,255,255,0.25); border-color:rgba(255,255,255,0.5); transform:scale(1.04); box-shadow:0 8px 32px rgba(0,0,0,.15); }


/* Ad Slider */
.ad-slider-section { margin:24px 0 28px; }
.ad-slider-outer { position:relative; }
.ad-slider-wrap { overflow:hidden; border-radius:16px; }
.ad-slider-track { display:flex; gap:12px; transition:transform .55s cubic-bezier(.4,0,.2,1); will-change:transform; }
.ad-card { flex:0 0 calc(25% - 9px); min-width:calc(25% - 9px); border-radius:16px; border:1px solid var(--border); background:var(--bg2); overflow:hidden; cursor:pointer; transition:all .3s; position:relative; display:flex; flex-direction:column; }
.ad-card:hover { border-color:rgba(139,92,246,.35); transform:translateY(-2px); box-shadow:0 12px 40px rgba(0,0,0,.12); }
.dark .ad-card:hover { box-shadow:0 12px 40px rgba(0,0,0,.4); }
.ad-card-banner { height:90px; position:relative; overflow:hidden; flex-shrink:0; }
.ad-card-banner-img { width:100%; height:100%; object-fit:cover; }
.ad-card-body { padding:12px 14px 14px; flex:1; display:flex; flex-direction:column; }
.ad-card-title { font-size:13px; font-weight:700; color:var(--text); line-height:1.35; margin-bottom:5px; }
.ad-card-desc { font-size:11px; color:var(--text3); line-height:1.5; flex:1; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
.ad-card-footer { display:flex; align-items:center; justify-content:space-between; margin-top:10px; }
.ad-card-cta { font-size:11px; font-weight:600; padding:5px 12px; border-radius:8px; transition:all .2s; }
.ad-card-meta { font-size:10px; color:var(--text4); }
/* Dots + nav row */
.ad-slider-bottom { display:flex; align-items:center; justify-content:center; gap:10px; margin-top:12px; }
.ad-slider-dots { display:flex; align-items:center; gap:6px; }
.ad-dot { width:6px; height:6px; border-radius:3px; background:var(--border); transition:all .3s; cursor:pointer; }
.ad-dot.active { width:18px; background:var(--violet); }
/* Desktop arrows ‚Äî sit outside the wrap, vertically centred on it */
.ad-slider-nav { position:absolute; top:50%; transform:translateY(-50%); width:30px; height:30px; border-radius:50%; background:var(--bg2); border:1px solid var(--border); display:flex; align-items:center; justify-content:center; color:var(--text3); transition:all .2s; z-index:5; box-shadow:0 2px 8px rgba(0,0,0,.1); }
.ad-slider-nav:hover { background:var(--violet); border-color:var(--violet); color:#fff; box-shadow:0 4px 14px rgba(139,92,246,.35); }
.ad-slider-prev { left:-16px; }
.ad-slider-next { right:-16px; }
/* Mobile: hide arrows, show only dots */
@media(max-width:767px) {
  .ad-card { flex:0 0 calc(50% - 6px); min-width:calc(50% - 6px); }
  .ad-slider-nav { display:none; }
}
@media(max-width:479px) {
  .ad-card { flex:0 0 calc(85% - 6px); min-width:calc(85% - 6px); }
}

/* Stats Bar (legacy for detail pages) */
.stat-card { position:relative; border-radius:16px; background:var(--bg2); border:1px solid var(--border); padding:16px; overflow:hidden; transition:all .3s; }
.stat-card:hover { border-color:rgba(139,92,246,.2); }
.stat-card .deco { position:absolute; top:0; right:0; width:60px; height:60px; border-bottom-left-radius:32px; opacity:.06; transition:opacity .3s; }
.stat-card:hover .deco { opacity:.12; }
.stat-icon { width:36px; height:36px; border-radius:10px; display:flex; align-items:center; justify-content:center; color:#fff; margin-bottom:12px; box-shadow:0 4px 12px rgba(0,0,0,.15); }
.stat-val { font-size:20px; font-weight:800; color:var(--text); }
.stat-label { font-size:10px; color:var(--text4); margin-top:2px; }

/* Channels Counter - removed */

/* Card */
.card { border-radius:16px; background:var(--bg2); border:1px solid var(--border); box-shadow:var(--card-shadow); transition:all .3s; overflow:hidden; }
.card:hover { border-color:rgba(139,92,246,.3); box-shadow:0 10px 40px rgba(139,92,246,.07); transform:translateY(-2px); }

/* Top Cards */
.top-grid { display:grid; grid-template-columns:1fr; gap:16px; margin-bottom:32px; }
@media(min-width:768px) { .top-grid { grid-template-columns:repeat(3,1fr); } }
.top-card-header { padding:14px 20px; display:flex; align-items:center; justify-content:space-between; }
.top-card-header h3 { display:flex; align-items:center; gap:8px; color:#fff; font-size:14px; font-weight:600; }
.top-card-header .icon-wrap { width:28px; height:28px; border-radius:8px; background:rgba(255,255,255,.2); display:flex; align-items:center; justify-content:center; }
.top-item { display:flex; align-items:center; gap:12px; padding:10px 12px; border-radius:12px; transition:background .15s; cursor:pointer; }
.top-item:hover { background:var(--bg3); }
.top-rank { width:24px; height:24px; border-radius:7px; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:700; flex-shrink:0; }
.top-avatar { width:32px; height:32px; border-radius:10px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:12px; font-weight:700; flex-shrink:0; }
.top-info { flex:1; min-width:0; }
.top-name { font-size:13px; font-weight:600; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; transition:color .2s; }
.top-item:hover .top-name { color:var(--violet); }
.top-username { font-size:10px; color:var(--text4); }
.top-val { font-size:13px; font-weight:700; flex-shrink:0; }
.top-view-all { display:block; width:calc(100% - 24px); margin:0 12px 12px; padding:10px; border-radius:12px; background:var(--bg3); text-align:center; font-size:13px; font-weight:500; color:var(--text3); transition:all .2s; }
.top-view-all:hover { color:var(--violet); background:rgba(139,92,246,.05); }

/* Category sidebar */
.main-layout { display:flex; gap:24px; }
.sidebar { display:none; width:240px; flex-shrink:0; }
@media(min-width:1024px) { .sidebar { display:block; } }
.sidebar-inner { position:sticky; top:84px; border-radius:16px; background:var(--bg2); border:1px solid var(--border); padding:12px; }
.sidebar-title { font-size:11px; font-weight:700; text-transform:uppercase; letter-spacing:1px; color:var(--text4); padding:4px 12px; margin-bottom:4px; }
.cat-btn { display:flex; align-items:center; gap:10px; width:100%; padding:10px 12px; border-radius:12px; font-size:13px; color:var(--text3); transition:all .2s; text-align:left; border:1px solid transparent; }
.cat-btn:hover { background:var(--bg3); color:var(--text); }
.cat-btn.active { background:rgba(139,92,246,.08); color:var(--violet); font-weight:600; border-color:rgba(139,92,246,.15); }
.cat-btn .count { margin-left:auto; font-size:11px; padding:2px 8px; border-radius:10px; background:var(--bg3); color:var(--text4); }
.cat-btn.active .count { background:rgba(139,92,246,.15); color:var(--violet); }
.content-area { flex:1; min-width:0; }

/* Mobile categories */
.mobile-cats { display:flex; overflow-x:auto; gap:8px; margin-bottom:24px; padding-bottom:4px; -ms-overflow-style:none; scrollbar-width:none; }
.mobile-cats::-webkit-scrollbar { display:none; }
@media(min-width:1024px) { .mobile-cats { display:none; } }
.mcat-btn { white-space:nowrap; padding:8px 14px; border-radius:12px; font-size:12px; font-weight:500; background:var(--bg3); border:1px solid transparent; color:var(--text3); transition:all .2s; display:flex; align-items:center; gap:6px; }
.mcat-btn.active { background:rgba(139,92,246,.08); color:var(--violet); border-color:rgba(139,92,246,.15); }

/* Sort tabs */
.sort-bar { border-radius:16px; background:var(--bg2); border:1px solid var(--border); padding:14px 16px; margin-bottom:20px; display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:12px; }
.sort-group { display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
.sort-icon { width:32px; height:32px; border-radius:8px; background:var(--bg3); display:flex; align-items:center; justify-content:center; color:var(--text4); }
.sort-pills { display:flex; background:var(--bg3); border-radius:12px; padding:3px; border:1px solid var(--border); }
.sort-pill { padding:7px 14px; border-radius:9px; font-size:12px; font-weight:500; color:var(--text3); transition:all .2s; display:flex; align-items:center; gap:5px; }
.sort-pill.active { background:var(--bg2); color:var(--violet); box-shadow:0 1px 3px rgba(0,0,0,.08); }
.dark .sort-pill.active { background:rgba(139,92,246,.2); }
.period-pills { display:none; }
.period-pills.show { display:flex; }
.period-pill { padding:7px 12px; border-radius:9px; font-size:12px; font-weight:500; color:var(--text3); transition:all .2s; }
.period-pill.active { background:var(--bg2); color:var(--emerald); box-shadow:0 1px 3px rgba(0,0,0,.08); }
.dark .period-pill.active { background:rgba(16,185,129,.15); }
.verified-btn { display:flex; align-items:center; gap:6px; padding:7px 12px; border-radius:12px; font-size:12px; font-weight:500; border:1px solid var(--border); background:var(--bg3); color:var(--text3); transition:all .2s; }
.verified-btn.active { background:rgba(59,130,246,.08); color:var(--blue); border-color:rgba(59,130,246,.2); }

/* Results info */
.results-info { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; font-size:13px; color:var(--text3); }
.results-info strong { color:var(--text); font-weight:700; }
.reset-btn { font-size:12px; color:var(--violet); transition:color .2s; }
.reset-btn:hover { color:var(--purple); }

/* Channel Cards Grid */
.channel-grid { display:grid; grid-template-columns:1fr; gap:16px; }
@media(min-width:768px) { .channel-grid { grid-template-columns:repeat(2,1fr); } }
.ch-card { position:relative; border-radius:16px; background:var(--bg2); border:1px solid var(--border); padding:20px; transition:all .3s; cursor:pointer; }
.ch-card:hover { border-color:rgba(139,92,246,.3); box-shadow:0 10px 40px rgba(139,92,246,.07); transform:translateY(-2px); }
.ch-rank { position:absolute; top:-10px; left:-10px; width:28px; height:28px; border-radius:8px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:11px; font-weight:700; box-shadow:0 4px 12px rgba(0,0,0,.2); z-index:2; }
.ch-actions { position:absolute; top:12px; right:12px; display:flex; gap:4px; opacity:0; transition:opacity .2s; z-index:2; }
.ch-card:hover .ch-actions { opacity:1; }
.ch-act-btn { padding:6px; border-radius:8px; background:var(--bg3); color:var(--text4); transition:all .2s; display:flex; align-items:center; justify-content:center; }
.ch-act-btn:hover { color:var(--violet); }
.ch-act-btn.fav-active { background:rgba(236,72,153,.1); color:var(--pink); }
.ch-act-btn.cmp-active { background:rgba(139,92,246,.1); color:var(--violet); }
.ch-top { display:flex; gap:14px; }
.ch-avatar { width:52px; height:52px; border-radius:14px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:20px; font-weight:700; flex-shrink:0; }
.ch-info { flex:1; min-width:0; }
.ch-name-row { display:flex; align-items:center; gap:6px; margin-bottom:2px; }
.ch-name { font-size:15px; font-weight:700; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; transition:color .2s; }
.ch-card:hover .ch-name { color:var(--violet); }
.ch-verified { color:var(--blue); flex-shrink:0; }
.ch-username { font-size:12px; color:var(--violet); margin-bottom:6px; }
.ch-desc { font-size:12px; color:var(--text3); line-height:1.5; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
.ch-tags { display:flex; flex-wrap:wrap; gap:4px; margin-top:10px; }
.ch-tag { font-size:10px; padding:2px 8px; border-radius:10px; background:var(--bg3); color:var(--text4); }
.ch-stats { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-top:12px; padding-top:12px; border-top:1px solid var(--border2); text-align:center; }
.ch-stat-val { display:flex; align-items:center; justify-content:center; gap:5px; font-size:13px; font-weight:700; margin-bottom:2px; }
.ch-stat-label { font-size:10px; color:var(--text4); }
.ch-er-row { display:flex; align-items:center; justify-content:space-between; margin-top:10px; }
.ch-er { font-size:10px; padding:4px 10px; border-radius:10px; background:rgba(139,92,246,.08); color:var(--violet); font-weight:600; }
.ch-posts { font-size:10px; padding:4px 10px; border-radius:10px; background:var(--bg3); color:var(--text4); }

/* Sparkline */
.sparkline { display:flex; align-items:center; justify-content:space-between; margin-top:10px; }
.sparkline span { font-size:10px; color:var(--text4); }

/* Empty state */
.empty-state { text-align:center; padding:60px 20px; }
.empty-icon { width:64px; height:64px; border-radius:16px; background:var(--bg3); display:flex; align-items:center; justify-content:center; margin:0 auto 16px; font-size:28px; }
.empty-title { font-size:18px; font-weight:700; color:var(--text); margin-bottom:8px; }
.empty-desc { font-size:13px; color:var(--text3); margin-bottom:16px; }
.primary-btn { padding:10px 24px; border-radius:12px; background:linear-gradient(135deg,#7c3aed,#3b82f6); color:#fff; font-size:13px; font-weight:600; transition:all .3s; }
.primary-btn:hover { box-shadow:0 8px 25px rgba(139,92,246,.3); transform:scale(1.03); }

/* Channel Detail Page */
.detail-bar { position:sticky; top:60px; z-index:40; backdrop-filter:blur(20px); background:rgba(255,255,255,.8); border-bottom:1px solid var(--border); }
.dark .detail-bar { background:rgba(8,8,26,.8); }
.detail-bar-inner { display:flex; align-items:center; justify-content:space-between; padding:10px 0; }
.back-btn { display:flex; align-items:center; gap:8px; font-size:13px; color:var(--text3); transition:color .2s; }
.back-btn:hover { color:var(--violet); }
.detail-actions { display:flex; align-items:center; gap:6px; }

/* Channel header card */
.ch-header-card { border-radius:24px; background:var(--bg2); border:1px solid var(--border); overflow:hidden; margin-bottom:24px; }
.ch-banner { height:100px; position:relative; overflow:hidden; }
@media(min-width:640px) { .ch-banner { height:130px; } }
.ch-header-body { padding:0 20px 24px; margin-top:-40px; position:relative; }
@media(min-width:640px) { .ch-header-body { padding:0 32px 24px; margin-top:-48px; } }
.ch-header-top { display:flex; flex-direction:column; gap:16px; }
@media(min-width:640px) { .ch-header-top { flex-direction:row; gap:20px; } }
.ch-big-avatar { width:80px; height:80px; border-radius:16px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:32px; font-weight:800; box-shadow:0 8px 24px rgba(0,0,0,.2); border:4px solid var(--bg2); flex-shrink:0; }
@media(min-width:640px) { .ch-big-avatar { width:96px; height:96px; font-size:38px; } }
.ch-header-info { padding-top:8px; }
@media(min-width:640px) { .ch-header-info { padding-top:16px; } }
.ch-big-name { font-size:22px; font-weight:800; color:var(--text); display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
.ch-big-username { font-size:14px; color:var(--violet); margin-top:2px; }
.ch-full-desc { font-size:13px; color:var(--text2); line-height:1.6; margin-top:12px; max-width:700px; }
.ch-rankings { display:flex; flex-wrap:wrap; gap:6px; margin-top:12px; }
.ch-ranking-badge { font-size:10px; padding:4px 10px; border-radius:10px; font-weight:600; display:inline-flex; align-items:center; gap:4px; }
.ch-detail-tags { display:flex; flex-wrap:wrap; gap:6px; margin-top:12px; }
.ch-detail-tag { font-size:11px; padding:4px 10px; border-radius:10px; background:var(--bg3); color:var(--text3); transition:color .2s; cursor:pointer; }
.ch-detail-tag:hover { color:var(--violet); }
.ch-meta-row { display:flex; flex-wrap:wrap; gap:8px; margin-top:16px; }
.ch-meta-item { display:flex; align-items:center; gap:5px; padding:6px 12px; border-radius:8px; background:var(--bg3); font-size:11px; color:var(--text3); }
.ch-meta-item.link { background:rgba(139,92,246,.08); color:var(--violet); transition:background .2s; cursor:pointer; }
.ch-meta-item.link:hover { background:rgba(139,92,246,.15); }

/* Detail stats grid */
.detail-stats { display:grid; grid-template-columns:repeat(2,1fr); gap:12px; margin-bottom:24px; }
@media(min-width:640px) { .detail-stats { grid-template-columns:repeat(3,1fr); } }
@media(min-width:1024px) { .detail-stats { grid-template-columns:repeat(6,1fr); } }

/* Chart container */
.chart-card { border-radius:16px; background:var(--bg2); border:1px solid var(--border); overflow:hidden; margin-bottom:24px; }
.chart-header { padding:16px 20px; border-bottom:1px solid var(--border2); display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:12px; }
.chart-title { font-size:14px; font-weight:700; color:var(--text); }
.chart-value { font-size:18px; font-weight:800; color:var(--text); margin-top:4px; }
.chart-change { font-size:11px; padding:2px 8px; border-radius:10px; font-weight:600; margin-left:8px; }
.chart-change.up { background:rgba(16,185,129,.1); color:var(--emerald); }
.chart-change.down { background:rgba(239,68,68,.1); color:var(--red); }
.chart-body { padding:20px; position:relative; }
.chart-svg { width:100%; }
.chart-tooltip { position:absolute; pointer-events:none; background:#0f172a; color:#fff; padding:6px 12px; border-radius:8px; font-size:11px; z-index:10; box-shadow:0 8px 20px rgba(0,0,0,.2); }
.dark .chart-tooltip { background:#fff; color:#0f172a; }
.chart-dates { display:flex; justify-content:space-between; margin-top:8px; padding:0 4px; font-size:10px; color:var(--text4); }
.chart-periods { display:flex; background:var(--bg3); border-radius:10px; padding:3px; border:1px solid var(--border); }
.chart-period-btn { padding:5px 12px; border-radius:7px; font-size:11px; font-weight:500; color:var(--text3); transition:all .2s; }
.chart-period-btn.active { background:var(--bg2); color:var(--text); box-shadow:0 1px 3px rgba(0,0,0,.08); }
.dark .chart-period-btn.active { background:rgba(255,255,255,.1); }

/* Charts grid */
.charts-grid { display:grid; grid-template-columns:1fr; gap:16px; margin-bottom:24px; }
@media(min-width:1024px) { .charts-grid { grid-template-columns:repeat(2,1fr); } }

/* Table */
.data-table { width:100%; border-collapse:collapse; }
.data-table th { text-align:left; padding:12px 20px; font-size:11px; font-weight:600; text-transform:uppercase; letter-spacing:.5px; color:var(--text4); border-bottom:1px solid var(--border2); }
.data-table th.right { text-align:right; }
.data-table td { padding:12px 20px; font-size:13px; border-bottom:1px solid var(--border2); }
.data-table td.right { text-align:right; }
.data-table tr:hover { background:var(--bg3); }
.data-table tr.today { background:rgba(139,92,246,.03); }
.dark .data-table tr.today { background:rgba(139,92,246,.05); }
.today-badge { font-size:9px; padding:2px 6px; border-radius:6px; background:rgba(139,92,246,.1); color:var(--violet); margin-left:6px; font-weight:600; }

/* Related */
.related-section { margin-bottom:32px; }
.related-title { font-size:18px; font-weight:700; color:var(--text); margin-bottom:16px; }

/* Top Page */
.top-page-title { text-align:center; margin-bottom:24px; padding-top:8px; }
.top-page-title h1 { font-size:28px; font-weight:800; color:var(--text); margin-bottom:4px; }
.top-page-title p { font-size:13px; color:var(--text3); }
.top-table-card { border-radius:16px; background:var(--bg2); border:1px solid var(--border); overflow:hidden; max-width:960px; margin:0 auto; }
.top-table tr.gold { background:linear-gradient(90deg,rgba(251,191,36,.05),transparent); }
.dark .top-table tr.gold { background:linear-gradient(90deg,rgba(251,191,36,.03),transparent); }
.top-table-rank { width:28px; height:28px; border-radius:8px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:11px; font-weight:700; box-shadow:0 2px 8px rgba(0,0,0,.15); }
.top-table-avatar { width:40px; height:40px; border-radius:12px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:14px; font-weight:700; flex-shrink:0; }
.top-table-name { font-size:13px; font-weight:600; color:var(--text); transition:color .2s; }
.top-table tr:hover .top-table-name { color:var(--violet); }
.top-table-username { font-size:10px; color:var(--text4); }
.er-badge { font-size:11px; padding:3px 8px; border-radius:8px; font-weight:500; }
.er-badge.high { background:rgba(16,185,129,.1); color:var(--emerald); }
.er-badge.mid { background:rgba(59,130,246,.1); color:var(--blue); }
.er-badge.low { background:var(--bg3); color:var(--text3); }

/* Compare page */
.compare-table { width:100%; border-collapse:collapse; }
.compare-table th { padding:16px 20px; text-align:center; border-bottom:1px solid var(--border2); min-width:160px; }
.compare-table th:first-child { min-width:140px; text-align:left; }
.compare-table td { padding:12px 20px; text-align:center; border-bottom:1px solid var(--border2); }
.compare-table td:first-child { text-align:left; }
.compare-table tr:hover { background:var(--bg3); }
.compare-avatar { width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:18px; font-weight:700; cursor:pointer; transition:transform .2s; margin:0 auto; position:relative; }
.compare-avatar:hover { transform:scale(1.1); }
.compare-remove { position:absolute; top:-6px; right:-6px; width:18px; height:18px; border-radius:9px; background:var(--red); color:#fff; font-size:10px; display:flex; align-items:center; justify-content:center; }
.best-badge { font-size:9px; padding:2px 6px; border-radius:6px; background:rgba(16,185,129,.1); color:var(--emerald); font-weight:600; margin-left:6px; }
.metric-cell { display:flex; align-items:center; gap:6px; }

/* Favorites page */
.fav-empty { min-height:50vh; display:flex; align-items:center; justify-content:center; }
.fav-empty-icon { width:80px; height:80px; border-radius:24px; display:flex; align-items:center; justify-content:center; margin:0 auto 16px; }

/* Recently viewed */
.recent-section { margin-bottom:32px; }
.recent-title { display:flex; align-items:center; gap:8px; font-size:14px; font-weight:600; color:var(--text); margin-bottom:12px; }
.recent-scroll { display:flex; gap:10px; overflow-x:auto; padding-bottom:8px; -ms-overflow-style:none; scrollbar-width:none; }
.recent-scroll::-webkit-scrollbar { display:none; }
.recent-card { display:flex; align-items:center; gap:10px; padding:10px 16px; border-radius:12px; background:var(--bg2); border:1px solid var(--border); min-width:200px; cursor:pointer; transition:all .2s; flex-shrink:0; }
.recent-card:hover { border-color:rgba(139,92,246,.3); }
.recent-avatar { width:36px; height:36px; border-radius:10px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:13px; font-weight:700; flex-shrink:0; }
.recent-name { font-size:13px; font-weight:600; color:var(--text); white-space:nowrap; transition:color .2s; }
.recent-card:hover .recent-name { color:var(--violet); }
.recent-subs { font-size:10px; color:var(--text4); }

/* Footer */
.footer { border-top:1px solid var(--border); margin-top:64px; background:var(--bg4); }
.footer-inner { padding:48px 0; display:grid; grid-template-columns:1fr; gap:32px; }
@media(min-width:768px) { .footer-inner { grid-template-columns:1fr 1fr 1fr 1fr; } }
.footer-brand p { font-size:13px; color:var(--text3); line-height:1.6; margin-top:12px; }
.footer-col h4 { font-size:13px; font-weight:700; color:var(--text); margin-bottom:12px; }
.footer-col button { display:block; font-size:13px; color:var(--text3); padding:3px 0; transition:color .2s; }
.footer-col button:hover { color:var(--violet); }
.footer-bottom { padding:20px 0; border-top:1px solid var(--border); display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:8px; font-size:11px; color:var(--text4); }

/* Mobile bottom nav */
.bottom-nav { display:flex; position:fixed; bottom:0; left:0; right:0; z-index:50; background:rgba(255,255,255,.92); backdrop-filter:blur(20px); border-top:1px solid var(--border); height:56px; align-items:center; justify-content:space-around; padding:0 8px; }
.dark .bottom-nav { background:rgba(10,10,26,.92); }
@media(min-width:1024px) { .bottom-nav { display:none; } }
.bnav-btn { display:flex; flex-direction:column; align-items:center; gap:2px; padding:4px 8px; color:var(--text4); transition:color .2s; position:relative; }
.bnav-btn:hover { color:var(--violet); }
.bnav-btn span { font-size:10px; }
.bnav-center { width:48px; height:48px; border-radius:16px; background:linear-gradient(135deg,#7c3aed,#3b82f6); color:#fff; display:flex; align-items:center; justify-content:center; margin-top:-16px; box-shadow:0 4px 16px rgba(139,92,246,.3); transition:transform .2s; }
.bnav-center:hover { transform:scale(1.1); }
.bnav-badge { position:absolute; top:-2px; right:0; min-width:14px; height:14px; border-radius:7px; font-size:8px; font-weight:700; display:flex; align-items:center; justify-content:center; color:#fff; padding:0 3px; }

/* Modal */
.modal-overlay { position:fixed; inset:0; z-index:100; display:flex; align-items:center; justify-content:center; padding:16px; }
.modal-backdrop { position:absolute; inset:0; background:rgba(0,0,0,.6); backdrop-filter:blur(4px); }
.modal-content { position:relative; width:100%; max-width:480px; border-radius:24px; background:var(--bg2); border:1px solid var(--border); box-shadow:0 24px 80px rgba(0,0,0,.2); max-height:90vh; overflow-y:auto; }
.dark .modal-content { background:#12122a; }
.modal-bar { height:5px; background:linear-gradient(90deg,#3b82f6,#8b5cf6,#7c3aed); border-radius:24px 24px 0 0; }
.modal-body { padding:24px; }
.modal-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:24px; }
.modal-title { font-size:20px; font-weight:800; color:var(--text); }
.modal-subtitle { font-size:13px; color:var(--text3); margin-top:2px; }
.form-group { margin-bottom:16px; }
.form-label { display:block; font-size:13px; font-weight:600; color:var(--text2); margin-bottom:6px; }
.form-label .req { color:var(--red); }
.form-input { width:100%; padding:12px 16px; border-radius:12px; background:var(--bg3); border:1px solid var(--border); font-size:13px; color:var(--text); outline:none; transition:all .2s; }
.form-input:focus { border-color:rgba(139,92,246,.5); box-shadow:0 0 0 3px rgba(139,92,246,.1); }
.form-input.error { border-color:var(--red); }
.form-error { font-size:11px; color:var(--red); margin-top:4px; display:flex; align-items:center; gap:4px; }
.form-select { width:100%; padding:12px 16px; border-radius:12px; background:var(--bg3); border:1px solid var(--border); font-size:13px; color:var(--text); outline:none; appearance:auto; }
.form-textarea { width:100%; padding:12px 16px; border-radius:12px; background:var(--bg3); border:1px solid var(--border); font-size:13px; color:var(--text); outline:none; resize:none; min-height:100px; transition:all .2s; }
.form-textarea:focus { border-color:rgba(139,92,246,.5); box-shadow:0 0 0 3px rgba(139,92,246,.1); }
.form-note { padding:12px 16px; border-radius:12px; background:var(--bg3); border:1px solid var(--border2); font-size:11px; color:var(--text3); line-height:1.5; margin-bottom:16px; }
.submit-btn { width:100%; padding:14px; border-radius:12px; background:linear-gradient(135deg,#3b82f6,#8b5cf6,#7c3aed); color:#fff; font-size:14px; font-weight:600; transition:all .3s; }
.submit-btn:hover { box-shadow:0 8px 25px rgba(139,92,246,.3); transform:scale(1.02); }

/* Share modal */
.share-link-row { display:flex; align-items:center; gap:8px; padding:12px; border-radius:12px; background:var(--bg3); border:1px solid var(--border); }
.share-link-row input { flex:1; background:transparent; border:none; font-size:13px; color:var(--text); outline:none; }
.share-copy-btn { padding:8px; border-radius:8px; background:rgba(139,92,246,.1); color:var(--violet); transition:all .2s; display:flex; align-items:center; justify-content:center; }
.share-copy-btn.copied { background:rgba(16,185,129,.1); color:var(--emerald); }
.copy-msg { text-align:center; font-size:12px; color:var(--emerald); margin-top:8px; }

/* Success state */
.success-state { text-align:center; padding:40px 0; }
.success-icon { width:64px; height:64px; border-radius:16px; display:flex; align-items:center; justify-content:center; margin:0 auto 16px; box-shadow:0 8px 24px rgba(16,185,129,.25); }
.progress-bar { height:5px; background:var(--bg3); border-radius:3px; overflow:hidden; margin-top:24px; }
.progress-fill { height:100%; background:linear-gradient(90deg,#10b981,#14b8a6); border-radius:3px; animation:progress 2.5s ease forwards; }

/* Gradient backgrounds */
.grad-violet { background:linear-gradient(135deg,#8b5cf6,#7c3aed); }
.grad-blue { background:linear-gradient(135deg,#3b82f6,#06b6d4); }
.grad-emerald { background:linear-gradient(135deg,#10b981,#14b8a6); }
.grad-amber { background:linear-gradient(135deg,#f59e0b,#ef4444); }
.grad-pink { background:linear-gradient(135deg,#ec4899,#f43f5e); }
.grad-indigo { background:linear-gradient(135deg,#6366f1,#3b82f6); }
.grad-teal { background:linear-gradient(135deg,#14b8a6,#22c55e); }
.grad-orange { background:linear-gradient(135deg,#f97316,#ef4444); }
.grad-red { background:linear-gradient(135deg,#ef4444,#ec4899); }
.grad-cyan { background:linear-gradient(135deg,#06b6d4,#3b82f6); }

/* Hidden class */
.hidden { display:none !important; }

/* Padding for bottom nav on mobile */
@media(max-width:1023px) {
  .main-content { padding-bottom:70px; }
}

/* SVG icons inline */
.icon { width:16px; height:16px; display:inline-block; vertical-align:middle; }
.icon-sm { width:14px; height:14px; }
.icon-xs { width:12px; height:12px; }
.icon-lg { width:20px; height:20px; }

/* Mini chart SVG in cards */
.mini-chart { flex-shrink:0; }

/* Responsive table scroll */
.table-scroll { overflow-x:auto; }

/* Dark select fix */
.dark select option { background:#1a1a3a; color:#fff; }

/* Pulse animation for notifications */
@keyframes pulseDot { 0%,100%{transform:scale(1);opacity:1} 50%{transform:scale(1.3);opacity:.8} }
.pulse-dot { animation:pulseDot 2s ease-in-out infinite; }

/* Auth modal tabs */
.auth-tabs { display:flex; background:var(--bg3); border-radius:12px; padding:3px; margin-bottom:20px; border:1px solid var(--border); }
.auth-tab { flex:1; padding:9px; border-radius:9px; font-size:13px; font-weight:600; color:var(--text3); transition:all .2s; text-align:center; }
.auth-tab.active { background:var(--bg2); color:var(--violet); box-shadow:0 1px 3px rgba(0,0,0,.08); }
.dark .auth-tab.active { background:rgba(139,92,246,.2); }

/* Auth input with icon */
.auth-input-wrap { position:relative; }
.auth-input-wrap svg { position:absolute; left:12px; top:50%; transform:translateY(-50%); color:var(--text4); pointer-events:none; width:15px; height:15px; }
.auth-input-wrap .form-input { padding-left:38px; }
.auth-input-wrap .eye-btn { position:absolute; right:10px; top:50%; transform:translateY(-50%); color:var(--text4); transition:color .2s; padding:4px; }
.auth-input-wrap .eye-btn:hover { color:var(--text); }

/* Auth divider */
.auth-divider { display:flex; align-items:center; gap:12px; margin:16px 0; }
.auth-divider::before,.auth-divider::after { content:''; flex:1; height:1px; background:var(--border); }
.auth-divider span { font-size:11px; color:var(--text4); white-space:nowrap; }

/* Auth social */
.auth-social-btn { display:flex; align-items:center; justify-content:center; gap:8px; width:100%; padding:11px; border-radius:12px; background:var(--bg3); border:1px solid var(--border); font-size:13px; font-weight:500; color:var(--text2); transition:all .2s; margin-bottom:8px; }
.auth-social-btn:hover { border-color:rgba(139,92,246,.3); background:var(--bg2); }

/* Profile page */
.profile-hero { border-radius:24px; overflow:hidden; margin-bottom:24px; position:relative; }
.profile-hero-bg { height:140px; background:linear-gradient(135deg,#7c3aed,#6d28d9,#3b82f6); position:relative; }
.profile-hero-pattern { position:absolute; inset:0; background-image:radial-gradient(rgba(255,255,255,.08) 1px,transparent 1px); background-size:20px 20px; }
.profile-avatar-wrap { position:relative; margin:-48px 0 0 28px; }
.profile-big-avatar { width:96px; height:96px; border-radius:24px; display:flex; align-items:center; justify-content:center; color:#fff; font-size:36px; font-weight:800; box-shadow:0 8px 24px rgba(0,0,0,.2); border:4px solid var(--bg2); }
.profile-info { padding:0 28px 24px; }
.profile-name { font-size:22px; font-weight:800; color:var(--text); margin-top:12px; }
.profile-email { font-size:13px; color:var(--text4); margin-top:4px; display:flex; align-items:center; gap:6px; }
.profile-badge { display:inline-flex; align-items:center; gap:5px; padding:3px 10px; border-radius:20px; font-size:11px; font-weight:600; margin-top:10px; }

/* Profile stats row */
.profile-stats-row { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-bottom:24px; }
.profile-stat-card { border-radius:16px; background:var(--bg2); border:1px solid var(--border); padding:16px; text-align:center; transition:all .2s; cursor:pointer; }
.profile-stat-card:hover { border-color:rgba(139,92,246,.3); transform:translateY(-1px); }
.profile-stat-num { font-size:26px; font-weight:800; margin-bottom:4px; }
.profile-stat-label { font-size:11px; color:var(--text4); }

/* Profile sections */
.profile-section { border-radius:16px; background:var(--bg2); border:1px solid var(--border); margin-bottom:16px; overflow:hidden; }
.profile-section-header { padding:16px 20px; border-bottom:1px solid var(--border2); display:flex; align-items:center; justify-content:space-between; }
.profile-section-title { font-size:14px; font-weight:700; color:var(--text); display:flex; align-items:center; gap:8px; }
.profile-section-body { padding:16px 20px; }

/* Settings form */
.settings-row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
@media(max-width:640px) { .settings-row { grid-template-columns:1fr; } }
.settings-save-btn { display:flex; align-items:center; gap:6px; padding:10px 20px; border-radius:12px; background:linear-gradient(135deg,#7c3aed,#3b82f6); color:#fff; font-size:13px; font-weight:600; transition:all .2s; }
.settings-save-btn:hover { box-shadow:0 6px 20px rgba(139,92,246,.3); transform:scale(1.02); }

/* Danger zone */
.danger-btn { display:flex; align-items:center; gap:6px; padding:9px 16px; border-radius:12px; border:1px solid rgba(239,68,68,.3); background:rgba(239,68,68,.05); color:var(--red); font-size:13px; font-weight:500; transition:all .2s; }
.danger-btn:hover { background:rgba(239,68,68,.1); border-color:var(--red); }
</style>
</head>
<body>
<div id="app"></div>
<script type="module" src="/src/main.tsx"></script>
<script>
// ========== DATA ==========
const avatarGrads = [
  'grad-violet','grad-blue','grad-emerald','grad-orange','grad-pink',
  'grad-indigo','grad-amber','grad-teal','grad-red','grad-cyan'
];
const categories = [
  {id:'all',name:'–í—Å–µ –∫–∞–Ω–∞–ª—ã',icon:'üìã'},{id:'news',name:'–ù–æ–≤–æ—Å—Ç–∏',icon:'üì∞'},
  {id:'tech',name:'–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',icon:'üíª'},{id:'crypto',name:'–ö—Ä–∏–ø—Ç–æ',icon:'‚Çø'},
  {id:'entertainment',name:'–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è',icon:'üé≠'},{id:'education',name:'–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ',icon:'üìö'},
  {id:'business',name:'–ë–∏–∑–Ω–µ—Å',icon:'üíº'},{id:'sport',name:'–°–ø–æ—Ä—Ç',icon:'‚öΩ'},
  {id:'music',name:'–ú—É–∑—ã–∫–∞',icon:'üéµ'},{id:'gaming',name:'–ò–≥—Ä—ã',icon:'üéÆ'},
  {id:'travel',name:'–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è',icon:'‚úàÔ∏è'},{id:'food',name:'–ï–¥–∞',icon:'üçï'},
  {id:'science',name:'–ù–∞—É–∫–∞',icon:'üî¨'},{id:'design',name:'–î–∏–∑–∞–π–Ω',icon:'üé®'},
  {id:'marketing',name:'–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥',icon:'üìà'}
];

const rawChannels = [
  {id:1,name:'MAX –ù–æ–≤–æ—Å—Ç–∏',username:'@maxnews',avatarIdx:0,category:'news',desc:'–ì–ª–∞–≤–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –¥–Ω—è –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ MAX. –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ, —á–µ—Å—Ç–Ω–æ, –±–µ–∑ —Ü–µ–Ω–∑—É—Ä—ã.',subscribers:1250000,views:890000,growthDay:3200,growthWeek:18500,growthMonth:72000,avgViews:450000,er:36,verified:true,postsPerDay:24,totalPosts:15840,tags:['–Ω–æ–≤–æ—Å—Ç–∏','—Ä–æ—Å—Å–∏—è','–º–∏—Ä']},
  {id:2,name:'TechHub MAX',username:'@techhubmax',avatarIdx:1,category:'tech',desc:'–û–±–∑–æ—Ä—ã –≥–∞–¥–∂–µ—Ç–æ–≤, IT-–Ω–æ–≤–æ—Å—Ç–∏, —Å—Ç–∞—Ä—Ç–∞–ø—ã –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–Ω–¥—ã.',subscribers:980000,views:720000,growthDay:2800,growthWeek:15200,growthMonth:58000,avgViews:380000,er:38.8,verified:true,postsPerDay:12,totalPosts:8640,tags:['—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏','IT','–≥–∞–¥–∂–µ—Ç—ã']},
  {id:3,name:'CryptoMAX',username:'@cryptomax',avatarIdx:2,category:'crypto',desc:'–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç, —Å–∏–≥–Ω–∞–ª—ã, –æ–±–∑–æ—Ä—ã —Ä—ã–Ω–∫–∞ 24/7.',subscribers:870000,views:650000,growthDay:4100,growthWeek:22000,growthMonth:85000,avgViews:320000,er:36.8,verified:true,postsPerDay:18,totalPosts:11520,tags:['–∫—Ä–∏–ø—Ç–æ','–±–∏—Ç–∫–æ–∏–Ω','DeFi']},
  {id:4,name:'MAX –ú–µ–º—ã',username:'@maxmemes',avatarIdx:3,category:'entertainment',desc:'–õ—É—á—à–∏–µ –º–µ–º—ã —Å–æ –≤—Å–µ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –°–º–µ—Ö –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç –∂–∏–∑–Ω—å! üòÇ',subscribers:2100000,views:1800000,growthDay:5500,growthWeek:32000,growthMonth:120000,avgViews:950000,er:45.2,verified:true,postsPerDay:30,totalPosts:21600,tags:['–º–µ–º—ã','—é–º–æ—Ä','—Å–º–µ—à–Ω–æ']},
  {id:5,name:'–ë–∏–∑–Ω–µ—Å –ò–Ω—Å–∞–π–¥—ã',username:'@bizinsider',avatarIdx:4,category:'business',desc:'–ë–∏–∑–Ω–µ—Å-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –∫–µ–π—Å—ã —É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π, –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏.',subscribers:750000,views:520000,growthDay:1800,growthWeek:9800,growthMonth:38000,avgViews:280000,er:37.3,verified:true,postsPerDay:8,totalPosts:4800,tags:['–±–∏–∑–Ω–µ—Å','—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏','–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏']},
  {id:6,name:'GameZone MAX',username:'@gamezonemax',avatarIdx:5,category:'gaming',desc:'–ù–æ–≤–æ—Å—Ç–∏ –∏–≥—Ä–æ–≤–æ–π –∏–Ω–¥—É—Å—Ç—Ä–∏–∏, –æ–±–∑–æ—Ä—ã, —Å—Ç—Ä–∏–º—ã –∏ –≥–∞–π–¥—ã.',subscribers:620000,views:480000,growthDay:2100,growthWeek:11500,growthMonth:44000,avgViews:250000,er:40.3,verified:false,postsPerDay:15,totalPosts:9000,tags:['–∏–≥—Ä—ã','–æ–±–∑–æ—Ä—ã','–≥–∞–π–¥—ã']},
  {id:7,name:'–ù–∞—É–∫–∞ MAX',username:'@sciencemax',avatarIdx:6,category:'science',desc:'–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç—ã –Ω–∞—É–∫–∏, –∫–æ—Å–º–æ—Å, —Ñ–∏–∑–∏–∫–∞ –∏ –æ—Ç–∫—Ä—ã—Ç–∏—è.',subscribers:540000,views:390000,growthDay:1500,growthWeek:8200,growthMonth:32000,avgViews:210000,er:38.9,verified:true,postsPerDay:6,totalPosts:3960,tags:['–Ω–∞—É–∫–∞','–∫–æ—Å–º–æ—Å','—Ñ–∏–∑–∏–∫–∞']},
  {id:8,name:'MAX –°–ø–æ—Ä—Ç',username:'@maxsport',avatarIdx:7,category:'sport',desc:'–í—Å–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞: —Ñ—É—Ç–±–æ–ª, —Ö–æ–∫–∫–µ–π, –±–∞—Å–∫–µ—Ç–±–æ–ª, MMA –∏ –Ω–µ —Ç–æ–ª—å–∫–æ.',subscribers:890000,views:670000,growthDay:2400,growthWeek:13500,growthMonth:52000,avgViews:340000,er:38.2,verified:true,postsPerDay:20,totalPosts:14400,tags:['—Å–ø–æ—Ä—Ç','—Ñ—É—Ç–±–æ–ª','MMA']},
  {id:9,name:'–î–∏–∑–∞–π–Ω & UI/UX',username:'@designmax',avatarIdx:8,category:'design',desc:'–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –¥–ª—è –¥–∏–∑–∞–π–Ω–µ—Ä–æ–≤, —Ç—Ä–µ–Ω–¥—ã UI/UX, –ø–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã.',subscribers:420000,views:310000,growthDay:1200,growthWeek:6800,growthMonth:26000,avgViews:165000,er:39.3,verified:false,postsPerDay:5,totalPosts:3000,tags:['–¥–∏–∑–∞–π–Ω','UI/UX','—Ç—Ä–µ–Ω–¥—ã']},
  {id:10,name:'–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è MAX',username:'@travelmax',avatarIdx:9,category:'travel',desc:'–õ—É—á—à–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –ª–∞–π—Ñ—Ö–∞–∫–∏ –¥–ª—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤, –≥–æ—Ä—è—â–∏–µ —Ç—É—Ä—ã.',subscribers:380000,views:280000,growthDay:950,growthWeek:5500,growthMonth:21000,avgViews:145000,er:38.2,verified:false,postsPerDay:4,totalPosts:2400,tags:['–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è','—Ç—É—Ä—ã','–ª–∞–π—Ñ—Ö–∞–∫–∏']},
  {id:11,name:'MAX –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ',username:'@maxedu',avatarIdx:0,category:'education',desc:'–û–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã, –ø–æ–ª–µ–∑–Ω—ã–µ –Ω–∞–≤—ã–∫–∏, —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ.',subscribers:680000,views:490000,growthDay:1900,growthWeek:10200,growthMonth:39000,avgViews:260000,er:38.2,verified:true,postsPerDay:7,totalPosts:4620,tags:['–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ','–∫—É—Ä—Å—ã','–Ω–∞–≤—ã–∫–∏']},
  {id:12,name:'–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ PRO',username:'@marketingpro',avatarIdx:1,category:'marketing',desc:'Digital-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥, SMM, —Ç–∞—Ä–≥–µ—Ç, SEO –∏ –∫–æ–Ω—Ç–µ–Ω—Ç-—Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.',subscribers:510000,views:370000,growthDay:1600,growthWeek:8900,growthMonth:34000,avgViews:195000,er:38.2,verified:true,postsPerDay:6,totalPosts:3600,tags:['–º–∞—Ä–∫–µ—Ç–∏–Ω–≥','SMM','SEO']},
  {id:13,name:'MAX Music',username:'@maxmusic',avatarIdx:2,category:'music',desc:'–ù–æ–≤–∏–Ω–∫–∏ –º—É–∑—ã–∫–∏, –ø–æ–¥–±–æ—Ä–∫–∏, –∫–æ–Ω—Ü–µ—Ä—Ç—ã –∏ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏.',subscribers:450000,views:340000,growthDay:1100,growthWeek:6200,growthMonth:24000,avgViews:180000,er:40.0,verified:false,postsPerDay:8,totalPosts:4800,tags:['–º—É–∑—ã–∫–∞','–Ω–æ–≤–∏–Ω–∫–∏','–∫–æ–Ω—Ü–µ—Ä—Ç—ã']},
  {id:14,name:'–ö—É–ª–∏–Ω–∞—Ä–Ω—ã–π MAX',username:'@foodmax',avatarIdx:3,category:'food',desc:'–†–µ—Ü–µ–ø—Ç—ã —Å–æ –≤—Å–µ–≥–æ –º–∏—Ä–∞, –∫—É–ª–∏–Ω–∞—Ä–Ω—ã–µ –ª–∞–π—Ñ—Ö–∞–∫–∏ –∏ –æ–±–∑–æ—Ä—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤.',subscribers:320000,views:240000,growthDay:800,growthWeek:4500,growthMonth:17000,avgViews:128000,er:40.0,verified:false,postsPerDay:5,totalPosts:2500,tags:['–µ–¥–∞','—Ä–µ—Ü–µ–ø—Ç—ã','–∫—É–ª–∏–Ω–∞—Ä–∏—è']},
  {id:15,name:'Breaking MAX',username:'@breakingmax',avatarIdx:4,category:'news',desc:'–°—Ä–æ—á–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è. –ü–µ—Ä–≤—ã–º–∏ —É–∑–Ω–∞–≤–∞–π—Ç–µ –æ –≥–ª–∞–≤–Ω–æ–º.',subscribers:1580000,views:1200000,growthDay:4800,growthWeek:26000,growthMonth:95000,avgViews:620000,er:39.2,verified:true,postsPerDay:35,totalPosts:25200,tags:['–Ω–æ–≤–æ—Å—Ç–∏','—Å—Ä–æ—á–Ω–æ','breaking']},
  {id:16,name:'AI & ML Hub',username:'@aimlhub',avatarIdx:5,category:'tech',desc:'–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç, –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∏ –±—É–¥—É—â–µ–µ.',subscribers:720000,views:530000,growthDay:3500,growthWeek:19000,growthMonth:73000,avgViews:280000,er:38.9,verified:true,postsPerDay:10,totalPosts:6000,tags:['AI','–Ω–µ–π—Ä–æ—Å–µ—Ç–∏','ML']},
  {id:17,name:'MAX –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏',username:'@maxinvest',avatarIdx:6,category:'business',desc:'–§–æ–Ω–¥–æ–≤—ã–π —Ä—ã–Ω–æ–∫, –∞–∫—Ü–∏–∏, –æ–±–ª–∏–≥–∞—Ü–∏–∏, ETF –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –∏–¥–µ–∏.',subscribers:660000,views:470000,growthDay:2000,growthWeek:11000,growthMonth:42000,avgViews:245000,er:37.1,verified:true,postsPerDay:9,totalPosts:5400,tags:['–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏','–∞–∫—Ü–∏–∏','ETF']},
  {id:18,name:'Esports MAX',username:'@esportsmax',avatarIdx:7,category:'gaming',desc:'–ö–∏–±–µ—Ä—Å–ø–æ—Ä—Ç: CS2, Dota 2, Valorant, LoL. –¢—É—Ä–Ω–∏—Ä—ã –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞.',subscribers:490000,views:380000,growthDay:1700,growthWeek:9500,growthMonth:36000,avgViews:200000,er:40.8,verified:false,postsPerDay:12,totalPosts:7200,tags:['–∫–∏–±–µ—Ä—Å–ø–æ—Ä—Ç','CS2','Dota']},
  {id:19,name:'–ö–æ—Å–º–æ—Å MAX',username:'@spacemax',avatarIdx:8,category:'science',desc:'–ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ –º–∏—Å—Å–∏–∏, –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—è, SpaceX –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤—Å–µ–ª–µ–Ω–Ω–æ–π.',subscribers:410000,views:300000,growthDay:1300,growthWeek:7200,growthMonth:28000,avgViews:160000,er:39.0,verified:true,postsPerDay:4,totalPosts:2640,tags:['–∫–æ—Å–º–æ—Å','NASA','SpaceX']},
  {id:20,name:'MAX Fitness',username:'@maxfitness',avatarIdx:9,category:'sport',desc:'–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –ø–∏—Ç–∞–Ω–∏–µ, –ó–û–ñ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –∂–∏–∑–Ω–∏.',subscribers:350000,views:260000,growthDay:900,growthWeek:5100,growthMonth:19500,avgViews:138000,er:39.4,verified:false,postsPerDay:6,totalPosts:3600,tags:['—Ñ–∏—Ç–Ω–µ—Å','—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏','–ó–û–ñ']},
  {id:21,name:'NFT & Web3',username:'@nftweb3max',avatarIdx:0,category:'crypto',desc:'NFT –∫–æ–ª–ª–µ–∫—Ü–∏–∏, Web3 –ø—Ä–æ–µ–∫—Ç—ã, –º–µ—Ç–∞–≤—Å–µ–ª–µ–Ω–Ω—ã–µ –∏ –±–ª–æ–∫—á–µ–π–Ω.',subscribers:560000,views:410000,growthDay:2600,growthWeek:14500,growthMonth:55000,avgViews:215000,er:38.4,verified:false,postsPerDay:11,totalPosts:6600,tags:['NFT','Web3','–±–ª–æ–∫—á–µ–π–Ω']},
  {id:22,name:'MAX Cinema',username:'@maxcinema',avatarIdx:1,category:'entertainment',desc:'–û–±–∑–æ—Ä—ã —Ñ–∏–ª—å–º–æ–≤ –∏ —Å–µ—Ä–∏–∞–ª–æ–≤, —Ç—Ä–µ–π–ª–µ—Ä—ã, —Ä–µ–π—Ç–∏–Ω–≥–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.',subscribers:780000,views:590000,growthDay:2200,growthWeek:12000,growthMonth:46000,avgViews:310000,er:39.7,verified:true,postsPerDay:8,totalPosts:5760,tags:['–∫–∏–Ω–æ','—Å–µ—Ä–∏–∞–ª—ã','–æ–±–∑–æ—Ä—ã']},
  {id:23,name:'–°—Ç–∞—Ä—Ç–∞–ø MAX',username:'@startupmax',avatarIdx:2,category:'business',desc:'–°—Ç–∞—Ä—Ç–∞–ø—ã, –≤–µ–Ω—á—É—Ä–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, –∞–∫—Å–µ–ª–µ—Ä–∞—Ç–æ—Ä—ã –∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ.',subscribers:430000,views:310000,growthDay:1400,growthWeek:7800,growthMonth:30000,avgViews:165000,er:38.4,verified:false,postsPerDay:5,totalPosts:3000,tags:['—Å—Ç–∞—Ä—Ç–∞–ø—ã','–≤–µ–Ω—á—É—Ä','–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏']},
  {id:24,name:'Python MAX',username:'@pythonmax',avatarIdx:3,category:'education',desc:'–£—Ä–æ–∫–∏ Python, –ø—Ä–æ–µ–∫—Ç—ã, –∑–∞–¥–∞—á–∏ –∏ –∫–∞—Ä—å–µ—Ä–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏.',subscribers:520000,views:380000,growthDay:1700,growthWeek:9300,growthMonth:36000,avgViews:200000,er:38.5,verified:true,postsPerDay:7,totalPosts:4200,tags:['Python','–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ','—É—Ä–æ–∫–∏']}
];

const fullDescs = {
  1:'MAX –ù–æ–≤–æ—Å—Ç–∏ ‚Äî –≤–∞—à –≥–ª–∞–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ MAX. –ú—ã –ø—É–±–ª–∏–∫—É–µ–º –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏–∑ –†–æ—Å—Å–∏–∏ –∏ –º–∏—Ä–∞, –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–∑–æ—Ä—ã, —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è. –ö–∞–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–∞–º—ã–º –≤–∞–∂–Ω—ã–º —Å–æ–±—ã—Ç–∏—è–º –¥–Ω—è.',
  2:'TechHub MAX ‚Äî –∫—Ä—É–ø–Ω–µ–π—à–∏–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∫–∞–Ω–∞–ª –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ MAX. –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ–±–∑–æ—Ä—ã –Ω–æ–≤—ã—Ö –≥–∞–¥–∂–µ—Ç–æ–≤, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ IT-—Ä—ã–Ω–∫–∞, –Ω–æ–≤–æ—Å—Ç–∏ —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–Ω–¥—ã.',
  3:'CryptoMAX ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞ 24/7. –¢–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑, –æ–±–∑–æ—Ä—ã –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.',
  4:'MAX –ú–µ–º—ã ‚Äî —Å–∞–º–æ–µ –≤–µ—Å—ë–ª–æ–µ –º–µ—Å—Ç–æ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ MAX! –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø–æ–¥–±–æ—Ä–∫–∏ –ª—É—á—à–∏—Ö –º–µ–º–æ–≤ —Å–æ –≤—Å–µ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ë–æ–ª–µ–µ 2 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –Ω–µ –º–æ–≥—É—Ç –æ—à–∏–±–∞—Ç—å—Å—è!',
  15:'Breaking MAX ‚Äî –∫–∞–Ω–∞–ª —Å—Ä–æ—á–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π. –ú—ã –ø–µ—Ä–≤—ã–º–∏ —Å–æ–æ–±—â–∞–µ–º –æ –≥–ª–∞–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö –≤ –†–æ—Å—Å–∏–∏ –∏ –º–∏—Ä–µ. 24/7 –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.',
  16:'AI & ML Hub ‚Äî –≤—Å—ë –æ–± –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–µ –∏ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏. –û–±–∑–æ—Ä—ã –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π, —Ç—É—Ç–æ—Ä–∏–∞–ª—ã –ø–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –∫–∞—Ä—å–µ—Ä–∞ –≤ AI.'
};

function genHistory(baseSubs, baseViews, days) {
  const h = []; let s = baseSubs - Math.floor(baseSubs*.15); const now = new Date();
  for(let i=days;i>=0;i--) {
    const d=new Date(now); d.setDate(d.getDate()-i);
    const g=Math.floor(Math.random()*(baseSubs*.004))+Math.floor(baseSubs*.0005);
    s+=g; const v=Math.floor(baseViews*(.7+Math.random()*.6));
    h.push({date:d.toISOString().split('T')[0],subscribers:s,views:v,growth:g});
  }
  return h;
}

const channels = rawChannels.map(ch => ({
  ...ch, avatar:avatarGrads[ch.avatarIdx],
  fullDesc:fullDescs[ch.id]||ch.desc,
  createdAt:'2023-0'+(1+ch.id%9)+'-'+String(10+ch.id%20).padStart(2,'0'),
  history:genHistory(ch.subscribers,ch.avgViews,90)
}));

// ========== UTILS ==========
function fmt(n) { if(n>=1e6) return (n/1e6).toFixed(1)+'M'; if(n>=1e3) return (n/1e3).toFixed(1)+'K'; return ''+n; }
function fmtFull(n) { return n.toLocaleString('ru-RU'); }
function getCat(id) { const c=categories.find(x=>x.id===id); return c?c.name:id; }
function getCatIcon(id) { const c=categories.find(x=>x.id===id); return c?c.icon:'üìã'; }
function catCount(id) { if(id==='all') return channels.length; return channels.filter(c=>c.category===id).length; }

function makeSvgSpark(data, key, color, w, h) {
  const vals = data.slice(-14).map(d=>d[key]);
  const max=Math.max(...vals), min=Math.min(...vals), range=max-min||1;
  const pts = vals.map((v,i)=>`${(i/(vals.length-1))*w},${h-2-((v-min)/range)*(h-4)}`).join(' ');
  return `<svg width="${w}" height="${h}" class="mini-chart"><polyline points="${pts}" fill="none" stroke="${color}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>`;
}

function makeChart(data, key, color, gradId, title, height) {
  const vals = data.map(d=>d[key]);
  const max=Math.max(...vals), min=Math.min(...vals), range=max-min||1;
  const W=100, H=height||240, pad={t:20,r:20,b:30,l:0};
  const iW=W-pad.l-pad.r, iH=H-pad.t-pad.b;
  const pts = vals.map((v,i)=>({x:pad.l+(i/(vals.length-1))*iW, y:pad.t+iH-((v-min)/range)*iH}));
  let pathD=''; pts.forEach((p,i)=>{
    if(i===0){pathD+=`M ${p.x} ${p.y}`}
    else{const pr=pts[i-1];pathD+=` C ${pr.x+(p.x-pr.x)*.4} ${pr.y}, ${pr.x+(p.x-pr.x)*.6} ${p.y}, ${p.x} ${p.y}`}
  });
  const areaD=pathD+` L ${pts[pts.length-1].x} ${pad.t+iH} L ${pts[0].x} ${pad.t+iH} Z`;
  let gridLines='';
  [0,.25,.5,.75,1].forEach(f=>{
    const y=pad.t+iH*(1-f); const v=min+range*f;
    gridLines+=`<line x1="${pad.l}" y1="${y}" x2="${pad.l+iW}" y2="${y}" stroke="currentColor" class="text-slate-100" stroke-width=".15" stroke-dasharray=".5,.5" style="color:var(--border2)"/>`;
    gridLines+=`<text x="${pad.l+iW+1}" y="${y+1}" font-size="2.5" fill="var(--text4)">${fmt(Math.round(v))}</text>`;
  });
  return `<svg viewBox="0 0 ${W} ${H}" class="chart-svg" style="height:${H}px" preserveAspectRatio="none">
    <defs><linearGradient id="${gradId}" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="${color}" stop-opacity=".3"/><stop offset="100%" stop-color="${color}" stop-opacity=".02"/></linearGradient></defs>
    ${gridLines}<path d="${areaD}" fill="url(#${gradId})"/><path d="${pathD}" fill="none" stroke="${color}" stroke-width=".4" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>`;
}

// ========== AUTH STATE ==========
let authUsers = JSON.parse(localStorage.getItem('mm_users')||'[]');
let currentUser = JSON.parse(localStorage.getItem('mm_current')||'null');

function saveUsers() { localStorage.setItem('mm_users',JSON.stringify(authUsers)); }
function saveCurrentUser() { localStorage.setItem('mm_current',JSON.stringify(currentUser)); }

function authRegister(name, email, password) {
  if(authUsers.find(u=>u.email===email)) return {ok:false,err:'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç'};
  const user = {id:Date.now(),name,email,password:btoa(password),avatar:'grad-violet',createdAt:new Date().toISOString(),plan:'–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π'};
  authUsers.push(user);
  saveUsers();
  currentUser = user;
  saveCurrentUser();
  return {ok:true};
}

function authLogin(email, password) {
  const u = authUsers.find(u=>u.email===email && u.password===btoa(password));
  if(!u) return {ok:false,err:'–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å'};
  currentUser = u;
  saveCurrentUser();
  return {ok:true};
}

function authLogout() {
  currentUser = null;
  localStorage.removeItem('mm_current');
}

// ========== STATE ==========
let state = {
  page:'home', channelId:null, topSort:'subscribers',
  search:'', category:'all', sortBy:'subscribers', timePeriod:'day', verifiedOnly:false,
  theme:localStorage.getItem('mm_theme')||'light', showModal:false, showNotif:false, showShare:false, shareLink:'',
  showProfile:false,
  showAuthModal:false, authTab:'login', authError:'', authShowPass:false,
  favs: JSON.parse(localStorage.getItem('mm_favs')||'[]'),
  compare: [], recent: JSON.parse(localStorage.getItem('mm_recent')||'[]'),
  mobileMenu:false
};

function saveFavs() { localStorage.setItem('mm_favs',JSON.stringify(state.favs)); }
function saveRecent() { localStorage.setItem('mm_recent',JSON.stringify(state.recent)); }
function toggleFav(id) { state.favs.includes(id)?state.favs=state.favs.filter(x=>x!==id):state.favs.push(id); saveFavs(); render(); }
function toggleCompare(id) { state.compare.includes(id)?state.compare=state.compare.filter(x=>x!==id):(state.compare.length<4&&state.compare.push(id)); render(); }
function addRecent(id) { state.recent=[id,...state.recent.filter(x=>x!==id)].slice(0,10); saveRecent(); }

function navigate(page, data) {
  state.mobileMenu=false; state.showNotif=false; state.showProfile=false;
  if(page==='home'){state.page='home';}
  else if(page==='channel'){state.page='channel';state.channelId=data;addRecent(data);}
  else if(page==='top'){state.page='top';state.topSort=data||'subscribers';}
  else if(page==='compare'){state.page='compare';}
  else if(page==='favorites'){state.page='favorites';}
  else if(page==='profile'){
    if(!currentUser){state.showAuthModal=true;render();return;}
    state.page='profile';
  }
  else if(page==='category'){state.category=data;state.page='home';}
  window.scrollTo({top:0,behavior:'smooth'});
  render();
}

function getFiltered() {
  let r=[...channels];
  if(state.search.trim()){const q=state.search.toLowerCase();r=r.filter(c=>c.name.toLowerCase().includes(q)||c.username.toLowerCase().includes(q)||c.desc.toLowerCase().includes(q)||c.tags.some(t=>t.toLowerCase().includes(q)));}
  if(state.category!=='all') r=r.filter(c=>c.category===state.category);
  if(state.verifiedOnly) r=r.filter(c=>c.verified);
  let sk=state.sortBy;
  if(sk==='growthDay'||sk==='growthWeek'||sk==='growthMonth'){sk=state.timePeriod==='day'?'growthDay':state.timePeriod==='week'?'growthWeek':'growthMonth';}
  r.sort((a,b)=>b[sk]-a[sk]);
  return r;
}

// ========== SVG ICONS ==========
const icons = {
  search:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>',
  sun:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>',
  moon:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>',
  menu:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>',
  x:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',
  home:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>',
  trending:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>',
  chart:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/></svg>',
  compare:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="6" cy="18" r="3"/><circle cx="18" cy="6" r="3"/><path d="M13 6h3a2 2 0 0 1 2 2v7"/><path d="M11 18H8a2 2 0 0 1-2-2V9"/></svg>',
  heart:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>',
  heartFill:'<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>',
  bell:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>',
  users:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>',
  eye:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>',
  check:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></svg>',
  back:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>',
  share:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/></svg>',
  copy:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>',
  crown:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7Z"/><path d="M4 18h16"/></svg>',
  plus:'<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M12 5v14"/><path d="M5 12h14"/></svg>',
  sparkle:'<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>',
  sort:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="m3 16 4 4 4-4"/><path d="M7 20V4"/><path d="m21 8-4-4-4 4"/><path d="M17 4v16"/></svg>',
  clock:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>',
  calendar:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/></svg>',
  globe:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></svg>',
  link:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>',
  chevron:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>',
  activity:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>',
  msg:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></svg>',
  badge:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z"/><path d="m9 12 2 2 4-4"/></svg>',
  zap:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>',
  hash:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="9" y2="9"/><line x1="4" x2="20" y1="15" y2="15"/><line x1="10" x2="8" y1="3" y2="21"/><line x1="16" x2="14" y1="3" y2="21"/></svg>',
  user:'<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="4"/><path d="M4 20c0-4 3.6-7 8-7s8 3 8 7"/></svg>',
  settings:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>',
  logout:'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>',
};

const logoSvg = `<svg width="36" height="36" viewBox="0 0 36 36" fill="none" class="logo-icon"><defs><linearGradient id="lBg" x1="0" y1="0" x2="36" y2="36" gradientUnits="userSpaceOnUse"><stop offset="0%" stop-color="#8b5cf6"/><stop offset="50%" stop-color="#7c3aed"/><stop offset="100%" stop-color="#3b82f6"/></linearGradient></defs><rect width="36" height="36" rx="10" fill="url(#lBg)"/><line x1="6" y1="26" x2="30" y2="26" stroke="white" stroke-opacity=".1" stroke-width=".5"/><line x1="6" y1="20" x2="30" y2="20" stroke="white" stroke-opacity=".07" stroke-width=".5"/><polyline points="7,24 13,19 18,21 23,13 29,9" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/><circle cx="29" cy="9" r="2.5" fill="white"/><circle cx="29" cy="9" r="1.2" fill="#3b82f6"/><rect x="8" y="27" width="3" height="3" rx=".8" fill="white" fill-opacity=".2"/><rect x="13" y="25" width="3" height="5" rx=".8" fill="white" fill-opacity=".25"/><rect x="18" y="26" width="3" height="4" rx=".8" fill="white" fill-opacity=".2"/><rect x="23" y="24" width="3" height="6" rx=".8" fill="white" fill-opacity=".3"/></svg>`;

// ========== RENDER ==========
function render() {
  document.body.className = state.theme;
  localStorage.setItem('mm_theme', state.theme);
  const app = document.getElementById('app');
  let html = '';
  html += renderHeader();
  if(state.page==='channel') html += renderChannelPage();
  else if(state.page==='top') html += renderTopPage();
  else if(state.page==='compare') html += renderComparePage();
  else if(state.page==='favorites') html += renderFavoritesPage();
  else if(state.page==='profile') html += renderProfilePage();
  else html += renderHomePage();
  html += renderFooter();
  html += renderBottomNav();
  if(state.showModal) html += renderAddModal();
  if(state.showShare) html += renderShareModal();
  if(state.showAuthModal) html += renderAuthModal();
  app.innerHTML = html;
  bindEvents();
}

function renderHeader() {
  const themeIcon = state.theme === 'dark'
    ? `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>`
    : `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>`;

  return `<header class="header"><div class="container"><div class="header-inner">

    <!-- –õ–æ–≥–æ—Ç–∏–ø -->
    <div class="logo" onclick="navigate('home')" style="flex-shrink:0">
      ${logoSvg}
      <div>
        <div class="logo-text"><span>Max</span>Metric</div>
        <div class="logo-sub">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ MAX</div>
      </div>
    </div>

    <!-- –ü–æ–∏—Å–∫ ‚Äî —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è -->
    <div class="header-search">
      <span class="hs-icon">${icons.search}</span>
      <input
        id="header-search-input"
        placeholder="–ü–æ–∏—Å–∫ –∫–∞–Ω–∞–ª–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, @username –∏–ª–∏ —Ç–µ–≥—É..."
        value="${state.search}"
        oninput="headerSearchInput(this.value)"
        onkeydown="if(event.key==='Escape'){headerSearchClear();}"
      />
      ${state.search ? `<button class="hs-clear" onclick="headerSearchClear()" title="–û—á–∏—Å—Ç–∏—Ç—å">${icons.x}</button>` : ''}
    </div>

    <!-- –¢–æ–ª—å–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
    <div class="header-actions" style="flex-shrink:0">
      <button
        class="icon-btn"
        onclick="state.theme=state.theme==='dark'?'light':'dark';render()"
        title="${state.theme==='dark'?'–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞':'–¢—ë–º–Ω–∞—è —Ç–µ–º–∞'}"
        style="width:38px;height:38px"
      >${themeIcon}</button>
    </div>

  </div></div></header>`;
}

function headerSearchInput(val) {
  state.search = val;
  if(state.page !== 'home') {
    state.category = 'all';
    state.page = 'home';
  }
  render();
  // Restore focus after re-render
  const inp = document.getElementById('header-search-input');
  if(inp) { inp.focus(); inp.setSelectionRange(val.length, val.length); }
}

function headerSearchClear() {
  state.search = '';
  render();
  const inp = document.getElementById('header-search-input');
  if(inp) inp.focus();
}

function renderProfileDropdown() {
  const myFavs = state.favs.length;
  const myCmp = state.compare.length;
  const myRecent = state.recent.length;
  return `<div class="notif-dropdown" onclick="event.stopPropagation()" style="width:280px">
    <div style="padding:16px;border-bottom:1px solid var(--border2)">
      <div style="display:flex;align-items:center;gap:12px">
        <div style="width:44px;height:44px;border-radius:14px;background:linear-gradient(135deg,#8b5cf6,#3b82f6);display:flex;align-items:center;justify-content:center;color:#fff;font-size:18px;font-weight:700">–ê</div>
        <div>
          <div style="font-size:14px;font-weight:700;color:var(--text)">–ê–Ω–æ–Ω–∏–º</div>
          <div style="font-size:11px;color:var(--text4);margin-top:2px">–ì–æ—Å—Ç—å ‚Ä¢ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω</div>
        </div>
      </div>
    </div>
    <div style="padding:8px">
      <div style="padding:4px 8px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text4);margin-bottom:4px">–ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:8px;padding:0 4px">
        <div style="text-align:center;padding:8px 4px;border-radius:10px;background:var(--bg3)">
          <div style="font-size:16px;font-weight:800;color:var(--pink)">${myFavs}</div>
          <div style="font-size:9px;color:var(--text4);margin-top:2px">–∏–∑–±—Ä–∞–Ω–Ω—ã—Ö</div>
        </div>
        <div style="text-align:center;padding:8px 4px;border-radius:10px;background:var(--bg3)">
          <div style="font-size:16px;font-weight:800;color:var(--violet)">${myCmp}</div>
          <div style="font-size:9px;color:var(--text4);margin-top:2px">–≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏</div>
        </div>
        <div style="text-align:center;padding:8px 4px;border-radius:10px;background:var(--bg3)">
          <div style="font-size:16px;font-weight:800;color:var(--blue)">${myRecent}</div>
          <div style="font-size:9px;color:var(--text4);margin-top:2px">–ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</div>
        </div>
      </div>
      <div style="padding:4px 8px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:var(--text4);margin-bottom:4px;margin-top:4px">–ú–µ–Ω—é</div>
      <button onclick="navigate('favorites');state.showProfile=false;" class="notif-item" style="width:100%;border-radius:10px;margin-bottom:2px;display:flex;align-items:center;gap:10px;text-align:left">
        <span style="width:28px;height:28px;border-radius:8px;background:rgba(236,72,153,.1);color:var(--pink);display:flex;align-items:center;justify-content:center">${icons.heartFill}</span>
        <div><div style="font-size:13px;font-weight:600;color:var(--text)">–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã</div><div style="font-size:10px;color:var(--text4)">${myFavs} –∫–∞–Ω–∞–ª–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ</div></div>
      </button>
      <button onclick="navigate('compare');state.showProfile=false;" class="notif-item" style="width:100%;border-radius:10px;margin-bottom:2px;display:flex;align-items:center;gap:10px;text-align:left">
        <span style="width:28px;height:28px;border-radius:8px;background:rgba(139,92,246,.1);color:var(--violet);display:flex;align-items:center;justify-content:center">${icons.compare}</span>
        <div><div style="font-size:13px;font-weight:600;color:var(--text)">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤</div><div style="font-size:10px;color:var(--text4)">${myCmp} –∏–∑ 4 –¥–æ–±–∞–≤–ª–µ–Ω–æ</div></div>
      </button>
      <button onclick="state.showModal=true;state.showProfile=false;render();" class="notif-item" style="width:100%;border-radius:10px;margin-bottom:2px;display:flex;align-items:center;gap:10px;text-align:left">
        <span style="width:28px;height:28px;border-radius:8px;background:rgba(16,185,129,.1);color:var(--emerald);display:flex;align-items:center;justify-content:center">${icons.plus}</span>
        <div><div style="font-size:13px;font-weight:600;color:var(--text)">–î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª</div><div style="font-size:10px;color:var(--text4)">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</div></div>
      </button>
      <div style="margin-top:8px;padding-top:8px;border-top:1px solid var(--border2);display:flex;align-items:center;justify-content:space-between;padding:8px 4px 4px">
        <button onclick="state.theme=state.theme==='dark'?'light':'dark';state.showProfile=false;render()" style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text3);padding:6px 10px;border-radius:8px;background:var(--bg3)">${state.theme==='dark'?icons.sun:icons.moon} ${state.theme==='dark'?'–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞':'–¢—ë–º–Ω–∞—è —Ç–µ–º–∞'}</button>
        <button onclick="state.favs=[];state.compare=[];state.recent=[];saveFavs();saveRecent();state.showProfile=false;render()" style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text4);padding:6px 10px;border-radius:8px">${icons.logout} –û—á–∏—Å—Ç–∏—Ç—å</button>
      </div>
    </div>
  </div>`;
}

function renderNotifDropdown() {
  const notifs = [
    {title:'–ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!',msg:'MAX –ú–µ–º—ã –¥–æ—Å—Ç–∏–≥–ª–∏ 2.1M –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤',time:'5 –º–∏–Ω –Ω–∞–∑–∞–¥',icon:'üèÜ',unread:true},
    {title:'–í–∑—Ä—ã–≤–Ω–æ–π —Ä–æ—Å—Ç',msg:'CryptoMAX: +4100 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –∑–∞ –¥–µ–Ω—å',time:'1 —á–∞—Å –Ω–∞–∑–∞–¥',icon:'üìà',unread:true},
    {title:'–ù–æ–≤—ã–π –∫–∞–Ω–∞–ª',msg:'AI & ML Hub –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–∞—Ç–∞–ª–æ–≥',time:'3 —á–∞—Å–∞ –Ω–∞–∑–∞–¥',icon:'‚ú®',unread:true},
    {title:'–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ',msg:'–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã',time:'1 –¥–µ–Ω—å –Ω–∞–∑–∞–¥',icon:'üîÑ',unread:false},
  ];
  return `<div class="notif-dropdown" onclick="event.stopPropagation()"><div class="notif-header" style="display:flex;align-items:center;justify-content:space-between"><span style="font-size:13px;font-weight:700;color:var(--text)">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span></div>${notifs.map(n=>`<div class="notif-item ${n.unread?'unread':''}"><span style="font-size:18px;flex-shrink:0">${n.icon}</span><div style="flex:1;min-width:0"><div style="font-size:13px;font-weight:600;color:var(--text)">${n.title}</div><div style="font-size:11px;color:var(--text3);margin-top:2px">${n.msg}</div><div style="font-size:10px;color:var(--text4);margin-top:4px">${n.time}</div></div>${n.unread?'<div style="width:8px;height:8px;border-radius:4px;background:var(--violet);flex-shrink:0;margin-top:6px"></div>':''}</div>`).join('')}</div>`;
}

function renderHomePage() {
  const filtered = getFiltered();
  let html = '<main class="main-content"><div class="container" style="padding-top:24px">';
  html += renderHero();
  html += renderAdSlider();
  if(state.recent.length>0 && !state.search && state.category==='all') html += renderRecent();
  html += renderTopChannels();
  html += renderMobileCats();
  html += '<div class="main-layout">';
  html += renderSidebar();
  html += '<div class="content-area">';
  html += renderSortBar();
  html += `<div class="results-info"><span>–ù–∞–π–¥–µ–Ω–æ: <strong>${filtered.length}</strong> –∫–∞–Ω–∞–ª–æ–≤${state.verifiedOnly?' <span style="font-size:10px;padding:2px 8px;border-radius:10px;background:rgba(59,130,246,.08);color:var(--blue)">‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</span>':''}</span>${state.category!=='all'?`<button class="reset-btn" onclick="state.category='all';render()">–°–±—Ä–æ—Å–∏—Ç—å ‚úï</button>`:''}</div>`;
  if(filtered.length===0) {
    html += `<div class="empty-state"><div class="empty-icon">üîç</div><div class="empty-title">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div><div class="empty-desc">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</div><button class="primary-btn" onclick="state.search='';state.category='all';state.verifiedOnly=false;render()">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button></div>`;
  } else {
    html += '<div class="channel-grid">';
    filtered.forEach((ch,i) => html += renderChannelCard(ch,i+1));
    html += '</div>';
  }
  html += '</div></div></div></main>';
  return html;
}

function renderHero() {
  return `<div class="hero"><div class="hero-bg"></div><div class="hero-pattern"></div><div class="hero-deco1"></div><div class="hero-deco2"></div>
    <svg style="position:absolute;bottom:0;left:0;right:0;height:60px;opacity:.1" viewBox="0 0 400 60" preserveAspectRatio="none"><polyline points="0,50 40,40 80,45 120,30 160,35 200,20 240,25 280,15 320,18 360,10 400,15" fill="none" stroke="white" stroke-width="1.5"/><polygon points="0,50 40,40 80,45 120,30 160,35 200,20 240,25 280,15 320,18 360,10 400,15 400,60 0,60" fill="white" fill-opacity=".05"/></svg>
    <div class="hero-content">
      <div class="hero-badge">${icons.sparkle} –ö–∞—Ç–∞–ª–æ–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ MAX</div>
      <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–∞–Ω–∞–ª–æ–≤<br><span>–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ MAX</span></h2>
      <p>–†–µ–π—Ç–∏–Ω–≥–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–æ—Å—Ç–∞ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤. –í—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.</p>
      <div class="hero-actions">
        <button class="hero-add-btn" onclick="state.showModal=true;render()">${icons.plus} –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª</button>
      </div>
    </div></div>`;
}


function renderAdSlider() {
  // –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —Ç–æ–ª—å–∫–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç –∏ –∞–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç –º–µ–Ω—è—é—Ç—Å—è
  const ads = [
    {
      grad:'linear-gradient(135deg,#7c3aed,#4f46e5)',
      accent:'#a78bfa',
      accentBg:'rgba(139,92,246,.18)',
      deco:'<circle cx="130" cy="-10" r="70" fill="rgba(255,255,255,.06)"/><circle cx="-10" cy="80" r="45" fill="rgba(255,255,255,.04)"/>',
      icon:'üìä',
      title:'–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –∫–∞–Ω–∞–ª –≤ —Ç–æ–ø–µ',
      desc:'–ü–æ–ª—É—á–∏—Ç–µ —Ç—ã—Å—è—á–∏ –Ω–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ —Å —Ä–µ–∫–ª–∞–º–Ω—ã–º —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º –≤ MaxMetric',
      cta:'–ü–æ–¥—Ä–æ–±–Ω–µ–µ',
      meta:'–æ—Ç 990 ‚ÇΩ/–º–µ—Å'
    },
    {
      grad:'linear-gradient(135deg,#0ea5e9,#06b6d4)',
      accent:'#67e8f9',
      accentBg:'rgba(6,182,212,.18)',
      deco:'<circle cx="130" cy="-10" r="70" fill="rgba(255,255,255,.06)"/><circle cx="-10" cy="80" r="45" fill="rgba(255,255,255,.04)"/>',
      icon:'üìà',
      title:'–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞',
      desc:'–ì–ª—É–±–æ–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ø—Ä–æ–≥–Ω–æ–∑—ã —Ä–æ—Å—Ç–∞ –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á—ë—Ç—ã –¥–ª—è –≤–∞—à–µ–≥–æ –∫–∞–Ω–∞–ª–∞',
      cta:'–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å',
      meta:'–ë–µ—Å–ø–ª–∞—Ç–Ω–æ 7 –¥–Ω–µ–π'
    },
    {
      grad:'linear-gradient(135deg,#10b981,#059669)',
      accent:'#6ee7b7',
      accentBg:'rgba(16,185,129,.18)',
      deco:'<circle cx="130" cy="-10" r="70" fill="rgba(255,255,255,.06)"/><circle cx="-10" cy="80" r="45" fill="rgba(255,255,255,.04)"/>',
      icon:'üèÖ',
      title:'–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–∞–Ω–∞–ª–∞',
      desc:'–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∑–Ω–∞—á–æ–∫ –ø–æ–≤—ã—à–∞–µ—Ç –¥–æ–≤–µ—Ä–∏–µ –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏ –≤–∏–¥–∏–º–æ—Å—Ç—å –≤ –ø–æ–∏—Å–∫–µ',
      cta:'–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É',
      meta:'–ë–µ—Å–ø–ª–∞—Ç–Ω–æ'
    },
    {
      grad:'linear-gradient(135deg,#f59e0b,#f97316)',
      accent:'#fcd34d',
      accentBg:'rgba(245,158,11,.18)',
      deco:'<circle cx="130" cy="-10" r="70" fill="rgba(255,255,255,.06)"/><circle cx="-10" cy="80" r="45" fill="rgba(255,255,255,.04)"/>',
      icon:'ü§ù',
      title:'–ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞',
      desc:'–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –¥–æ 30% –∫–æ–º–∏—Å—Å–∏–∏ –∑–∞ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–≤–ª–µ—á—ë–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
      cta:'–£–∑–Ω–∞—Ç—å —É—Å–ª–æ–≤–∏—è',
      meta:'–¥–æ 30% –∫–æ–º–∏—Å—Å–∏–∏'
    },
    {
      grad:'linear-gradient(135deg,#ec4899,#8b5cf6)',
      accent:'#f9a8d4',
      accentBg:'rgba(236,72,153,.18)',
      deco:'<circle cx="130" cy="-10" r="70" fill="rgba(255,255,255,.06)"/><circle cx="-10" cy="80" r="45" fill="rgba(255,255,255,.04)"/>',
      icon:'üëë',
      title:'Premium-–∞–∫–∫–∞—É–Ω—Ç',
      desc:'–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã',
      cta:'–û—Ñ–æ—Ä–º–∏—Ç—å',
      meta:'–æ—Ç 1 490 ‚ÇΩ/–º–µ—Å'
    },
    {
      grad:'linear-gradient(135deg,#6366f1,#3b82f6)',
      accent:'#93c5fd',
      accentBg:'rgba(59,130,246,.18)',
      deco:'<circle cx="130" cy="-10" r="70" fill="rgba(255,255,255,.06)"/><circle cx="-10" cy="80" r="45" fill="rgba(255,255,255,.04)"/>',
      icon:'üì≤',
      title:'–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ MaxMetric',
      desc:'–°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∫–∞–Ω–∞–ª–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä—è–º–æ —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞',
      cta:'–°–∫–∞—á–∞—Ç—å',
      meta:'iOS –∏ Android'
    }
  ];

  const cards = ads.map((ad,i) => `
    <div class="ad-card" onclick="handleAdClick(${i})">
      <div class="ad-card-banner" style="background:${ad.grad}">
        <svg style="position:absolute;inset:0;width:100%;height:100%" viewBox="0 0 150 90" preserveAspectRatio="xMidYMid slice">${ad.deco}</svg>
        <div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:34px;filter:drop-shadow(0 2px 8px rgba(0,0,0,.2))">${ad.icon}</div>
      </div>
      <div class="ad-card-body">
        <div class="ad-card-title">${ad.title}</div>
        <div class="ad-card-desc">${ad.desc}</div>
        <div class="ad-card-footer">
          <button class="ad-card-cta" style="background:${ad.accentBg};color:${ad.accent}">${ad.cta} ‚Üí</button>
          <span class="ad-card-meta">${ad.meta}</span>
        </div>
      </div>
    </div>`).join('');

  return `<div class="ad-slider-section">
    <div class="ad-slider-outer">
      <div class="ad-slider-wrap" id="ad-wrap">
        <div class="ad-slider-track" id="ad-track">${cards}</div>
      </div>
      <button class="ad-slider-nav ad-slider-prev" id="ad-prev" onclick="adSliderPrev()" aria-label="–ù–∞–∑–∞–¥">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="m15 18-6-6 6-6"/></svg>
      </button>
      <button class="ad-slider-nav ad-slider-next" id="ad-next" onclick="adSliderNext()" aria-label="–í–ø–µ—Ä—ë–¥">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="m9 18 6-6-6-6"/></svg>
      </button>
    </div>
    <div class="ad-slider-bottom">
      <div class="ad-slider-dots" id="ad-dots">
        ${ads.map((_,i)=>`<div class="ad-dot${i===0?' active':''}" onclick="adSliderGoTo(${i})" id="ad-dot-${i}"></div>`).join('')}
      </div>
    </div>
  </div>`;
}

function handleAdClick(i) {
  // placeholder ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥
}

// stats removed

function renderRecent() {
  const rc = state.recent.map(id=>channels.find(c=>c.id===id)).filter(Boolean).slice(0,6);
  if(!rc.length) return '';
  return `<div class="recent-section"><div class="recent-title">${icons.clock} –ù–µ–¥–∞–≤–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ</div><div class="recent-scroll">${rc.map(ch=>`<div class="recent-card" onclick="navigate('channel',${ch.id})"><div class="recent-avatar ${ch.avatar}">${ch.name[0]}</div><div><div class="recent-name">${ch.name}</div><div class="recent-subs">${fmt(ch.subscribers)} –ø–æ–¥–ø.</div></div></div>`).join('')}</div></div>`;
}

function renderTopChannels() {
  const bySubs=[...channels].sort((a,b)=>b.subscribers-a.subscribers).slice(0,5);
  const byViews=[...channels].sort((a,b)=>b.views-a.views).slice(0,5);
  const byGrowth=[...channels].sort((a,b)=>b.growthDay-a.growthDay).slice(0,5);
  function topCard(title,icon,grad,chs,vk,isG) {
    const ranks=['background:rgba(251,191,36,.12);color:#f59e0b','background:rgba(148,163,184,.15);color:#94a3b8','background:rgba(251,146,60,.12);color:#fb923c','background:var(--bg3);color:var(--text4)','background:var(--bg3);color:var(--text4)'];
    return `<div class="card"><div class="top-card-header" style="background:linear-gradient(135deg,${grad})"><h3><div class="icon-wrap">${icon}</div>${title}</h3>${icons.crown}</div><div style="padding:8px">${chs.map((ch,i)=>`<div class="top-item" onclick="navigate('channel',${ch.id})"><div class="top-rank" style="${ranks[i]}">${i+1}</div><div class="top-avatar ${ch.avatar}">${ch.name[0]}</div><div class="top-info"><div class="top-name">${ch.name}</div><div class="top-username">${ch.username}</div></div><div class="top-val" style="color:${isG?'var(--emerald)':'var(--text)'}">${isG?'+':''}${fmt(ch[vk])}</div></div>`).join('')}</div><button class="top-view-all" onclick="navigate('top','${vk}')">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ ‚Üí</button></div>`;
  }
  return `<div class="top-grid">${topCard('–¢–æ–ø –ø–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º',icons.users,'#3b82f6,#06b6d4',bySubs,'subscribers',false)}${topCard('–¢–æ–ø –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º',icons.eye,'#10b981,#14b8a6',byViews,'views',false)}${topCard('–¢–æ–ø –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É',icons.trending,'#8b5cf6,#a855f7',byGrowth,'growthDay',true)}</div>`;
}

function renderSidebar() {
  return `<div class="sidebar"><div class="sidebar-inner"><div class="sidebar-title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</div>${categories.map(c=>`<button class="cat-btn ${state.category===c.id?'active':''}" onclick="state.category='${c.id}';render()"><span>${c.icon}</span><span style="flex:1;text-align:left">${c.name}</span><span class="count">${catCount(c.id)}</span></button>`).join('')}
  <div style="margin-top:16px;padding-top:16px;border-top:1px solid var(--border2);padding:16px 12px 0"><div class="sidebar-title">–ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏</div><div style="display:flex;justify-content:space-between;font-size:12px;margin:8px 0"><span style="color:var(--text3)">–í—Å–µ–≥–æ –∫–∞–Ω–∞–ª–æ–≤</span><span style="font-weight:700;color:var(--text)">${channels.length}</span></div><div style="display:flex;justify-content:space-between;font-size:12px;margin:8px 0"><span style="color:var(--text3)">–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö</span><span style="font-weight:700;color:var(--emerald)">${channels.filter(c=>c.verified).length}</span></div></div>
  </div></div>`;
}

function renderMobileCats() {
  return `<div class="mobile-cats">${categories.map(c=>`<button class="mcat-btn ${state.category===c.id?'active':''}" onclick="state.category='${c.id}';render()"><span>${c.icon}</span>${c.name}</button>`).join('')}</div>`;
}

function renderSortBar() {
  const isG = state.sortBy==='growthDay'||state.sortBy==='growthWeek'||state.sortBy==='growthMonth';
  return `<div class="sort-bar" id="ch-list"><div class="sort-group"><div class="sort-icon">${icons.sort}</div>
    <div class="sort-pills">
      <button class="sort-pill ${state.sortBy==='subscribers'?'active':''}" onclick="state.sortBy='subscribers';render()">${icons.users} –ü–æ–¥–ø–∏—Å—á–∏–∫–∏</button>
      <button class="sort-pill ${state.sortBy==='views'?'active':''}" onclick="state.sortBy='views';render()">${icons.eye} –ü—Ä–æ—Å–º–æ—Ç—Ä—ã</button>
      <button class="sort-pill ${isG?'active':''}" onclick="state.sortBy='growthDay';render()">${icons.trending} –ü—Ä–∏—Ä–æ—Å—Ç</button>
    </div></div>
    <div class="sort-group">
      <div class="sort-pills period-pills ${isG?'show':''}">
        <button class="period-pill ${state.timePeriod==='day'?'active':''}" onclick="state.timePeriod='day';state.sortBy='growthDay';render()">–î–µ–Ω—å</button>
        <button class="period-pill ${state.timePeriod==='week'?'active':''}" onclick="state.timePeriod='week';state.sortBy='growthWeek';render()">–ù–µ–¥–µ–ª—è</button>
        <button class="period-pill ${state.timePeriod==='month'?'active':''}" onclick="state.timePeriod='month';state.sortBy='growthMonth';render()">–ú–µ—Å—è—Ü</button>
      </div>
      <button class="verified-btn ${state.verifiedOnly?'active':''}" onclick="state.verifiedOnly=!state.verifiedOnly;render()">${icons.check} <span class="hide-mobile">–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</span><span class="show-mobile">‚úì</span></button>
    </div></div>`;
}

function renderChannelCard(ch, rank) {
  const isFav=state.favs.includes(ch.id), isCmp=state.compare.includes(ch.id);
  const rankGrad = rank<=3?[,'linear-gradient(135deg,#fbbf24,#d97706)','linear-gradient(135deg,#94a3b8,#64748b)','linear-gradient(135deg,#fb923c,#ea580c)'][rank]:'linear-gradient(135deg,#8b5cf6,#7c3aed)';
  const growthKey = state.timePeriod==='day'?'growthDay':state.timePeriod==='week'?'growthWeek':'growthMonth';
  return `<div class="ch-card fade-in" style="animation-delay:${Math.min(rank*30,300)}ms" onclick="navigate('channel',${ch.id})">
    <div class="ch-rank" style="background:${rankGrad}">${rank}</div>
    <div class="ch-actions">
      <button class="ch-act-btn ${isCmp?'cmp-active':''}" onclick="event.stopPropagation();toggleCompare(${ch.id})" title="–°—Ä–∞–≤–Ω–∏—Ç—å">${icons.compare}</button>
      <button class="ch-act-btn ${isFav?'fav-active':''}" onclick="event.stopPropagation();toggleFav(${ch.id})" title="–ò–∑–±—Ä–∞–Ω–Ω–æ–µ">${isFav?icons.heartFill:icons.heart}</button>
    </div>
    <div class="ch-top"><div class="ch-avatar ${ch.avatar}">${ch.name[0]}</div><div class="ch-info"><div class="ch-name-row"><span class="ch-name">${ch.name}</span>${ch.verified?`<span class="ch-verified">${icons.badge}</span>`:''}</div><div class="ch-username">${ch.username}</div><div class="ch-desc">${ch.desc}</div></div></div>
    ${ch.tags.length?`<div class="ch-tags">${ch.tags.slice(0,3).map(t=>`<span class="ch-tag">#${t}</span>`).join('')}</div>`:''}
    <div class="sparkline">${makeSvgSpark(ch.history,'subscribers','#8b5cf6',120,28)}<span>14 –¥–Ω–µ–π</span></div>
    <div class="ch-stats">
      <div><div class="ch-stat-val" style="color:var(--blue)">${icons.users} ${fmt(ch.subscribers)}</div><div class="ch-stat-label">–ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div></div>
      <div><div class="ch-stat-val" style="color:var(--emerald)">${icons.eye} ${fmt(ch.avgViews)}</div><div class="ch-stat-label">–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</div></div>
      <div><div class="ch-stat-val" style="color:var(--emerald)">+${fmt(ch[growthKey])}</div><div class="ch-stat-label">–∑–∞ ${state.timePeriod==='day'?'–¥–µ–Ω—å':state.timePeriod==='week'?'–Ω–µ–¥–µ–ª—é':'–º–µ—Å—è—Ü'}</div></div>
    </div>
    <div class="ch-er-row"><span class="ch-er">ER: ${ch.er}%</span><span class="ch-posts">${ch.postsPerDay} –ø–æ—Å—Ç/–¥–µ–Ω—å</span></div>
  </div>`;
}

function renderChannelPage() {
  const ch = channels.find(c=>c.id===state.channelId);
  if(!ch) return '<div class="container" style="padding:40px;text-align:center">–ö–∞–Ω–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω</div>';
  const hist=ch.history, last7=hist.slice(-7), last30=hist.slice(-30);
  const avgG7=Math.floor(last7.reduce((a,d)=>a+d.growth,0)/7);
  const avgG30=Math.floor(last30.reduce((a,d)=>a+d.growth,0)/30);
  const maxG=Math.max(...last30.map(d=>d.growth));
  const isFav=state.favs.includes(ch.id), isCmp=state.compare.includes(ch.id);
  const subsRank=[...channels].sort((a,b)=>b.subscribers-a.subscribers).findIndex(c=>c.id===ch.id)+1;
  const viewsRank=[...channels].sort((a,b)=>b.avgViews-a.avgViews).findIndex(c=>c.id===ch.id)+1;
  const growthRank=[...channels].sort((a,b)=>b.growthDay-a.growthDay).findIndex(c=>c.id===ch.id)+1;
  const related = channels.filter(c=>c.category===ch.category&&c.id!==ch.id).slice(0,4);
  const daysActive = Math.floor((Date.now()-new Date(ch.createdAt).getTime())/(864e5));

  let html = `<div class="detail-bar"><div class="container"><div class="detail-bar-inner">
    <button class="back-btn" onclick="navigate('home')">${icons.back} –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–∞–ª–æ–≥—É</button>
    <div class="detail-actions">
      <button class="icon-btn" onclick="navigate('category','${ch.category}')" style="font-size:12px;padding:6px 12px">${getCatIcon(ch.category)} ${getCat(ch.category)}</button>
      <button class="icon-btn ${isCmp?'cmp-active':''}" onclick="toggleCompare(${ch.id})" style="${isCmp?'background:rgba(139,92,246,.15);color:var(--violet);border-color:rgba(139,92,246,.3)':''}">${icons.compare}</button>
      <button class="icon-btn ${isFav?'fav-active':''}" onclick="toggleFav(${ch.id})" style="${isFav?'background:rgba(236,72,153,.1);color:var(--pink);border-color:rgba(236,72,153,.3)':''}">${isFav?icons.heartFill:icons.heart}</button>
      <button class="icon-btn" onclick="state.showShare=true;state.shareLink='https://max.me/${ch.username.replace('@','')}';render()">${icons.share}</button>
    </div></div></div></div>`;

  html += `<div class="container" style="padding-top:24px">`;

  // Header card
  html += `<div class="ch-header-card"><div class="ch-banner ${ch.avatar}" style="position:relative"><div style="position:absolute;inset:0;background:rgba(0,0,0,.1)"></div></div>
    <div class="ch-header-body"><div class="ch-header-top"><div class="ch-big-avatar ${ch.avatar}" style="border-color:var(--bg2)">${ch.name[0]}</div>
      <div class="ch-header-info"><div class="ch-big-name">${ch.name} ${ch.verified?icons.badge:''}</div><div class="ch-big-username">${ch.username}</div>
        <div class="ch-full-desc">${ch.fullDesc}</div>
        <div class="ch-rankings">
          <span class="ch-ranking-badge" style="background:rgba(251,191,36,.1);color:#d97706">üèÜ #${subsRank} –ø–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º</span>
          <span class="ch-ranking-badge" style="background:rgba(16,185,129,.1);color:var(--emerald)">üëÅ #${viewsRank} –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º</span>
          <span class="ch-ranking-badge" style="background:rgba(139,92,246,.1);color:var(--violet)">üìà #${growthRank} –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É</span>
        </div>
        <div class="ch-detail-tags">${ch.tags.map(t=>`<span class="ch-detail-tag">#${t}</span>`).join('')}</div>
        <div class="ch-meta-row">
          <span class="ch-meta-item">${icons.globe} –†—É—Å—Å–∫–∏–π</span>
          <span class="ch-meta-item">${icons.calendar} ${new Date(ch.createdAt).toLocaleDateString('ru-RU')}</span>
          <span class="ch-meta-item">${icons.clock} ${daysActive} –¥–Ω–µ–π</span>
          <span class="ch-meta-item link" onclick="window.open('https://max.me/${ch.username.replace('@','')}')">${icons.link} –û—Ç–∫—Ä—ã—Ç—å –≤ MAX</span>
        </div>
      </div></div></div></div>`;

  // Stats grid
  const detailStats = [
    {l:'–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤',v:fmtFull(ch.subscribers),icon:icons.users,g:'grad-blue'},
    {l:'–°—Ä. –ø—Ä–æ—Å–º–æ—Ç—Ä—ã',v:fmt(ch.avgViews),icon:icons.eye,g:'grad-emerald',sub:'–∑–∞ –ø–æ—Å—Ç'},
    {l:'–ü—Ä–∏—Ä–æ—Å—Ç/–¥–µ–Ω—å',v:'+'+fmt(ch.growthDay),icon:icons.trending,g:'grad-violet',sub:`—Å—Ä. +${fmt(avgG7)}/7–¥`},
    {l:'ER –∫–∞–Ω–∞–ª–∞',v:ch.er+'%',icon:icons.activity,g:'grad-amber',sub:'–≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å'},
    {l:'–ü–æ—Å—Ç–æ–≤/–¥–µ–Ω—å',v:''+ch.postsPerDay,icon:icons.msg,g:'grad-pink',sub:`–≤—Å–µ–≥–æ ${fmt(ch.totalPosts)}`},
    {l:'–ü—Ä–∏—Ä–æ—Å—Ç/–º–µ—Å',v:'+'+fmt(ch.growthMonth),icon:icons.chart,g:'grad-indigo',sub:`—Å—Ä. +${fmt(avgG30)}/–¥`},
  ];
  html += `<div class="detail-stats">${detailStats.map(s=>`<div class="stat-card"><div class="deco ${s.g}"></div><div class="stat-icon ${s.g}">${s.icon}</div><div class="stat-val">${s.v}</div><div class="stat-label">${s.l}</div>${s.sub?`<div class="stat-label">${s.sub}</div>`:''}</div>`).join('')}</div>`;

  // Extra stats
  html += `<div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:24px">
    ${[['–ü—Ä–∏—Ä–æ—Å—Ç –∑–∞ 7 –¥–Ω','+'+fmt(ch.growthWeek),makeSvgSpark(hist,'growth','#8b5cf6',100,28)],['–ú–∞–∫—Å. –ø—Ä–∏—Ä–æ—Å—Ç/–¥–µ–Ω—å','+'+fmt(maxG),'<div style="font-size:10px;color:var(--text4);margin-top:4px">–°—Ä: +'+fmt(avgG7)+'</div>'],['–°—Ä. –ø—Ä–æ—Å–º–æ—Ç—Ä—ã/7–¥',fmt(Math.floor(last7.reduce((a,d)=>a+d.views,0)/7)),makeSvgSpark(hist,'views','#10b981',100,28)],['–í—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤',fmtFull(ch.totalPosts),'<div style="font-size:10px;color:var(--text4);margin-top:4px">'+ch.postsPerDay+' –ø–æ—Å—Ç–æ–≤/–¥–µ–Ω—å</div>']].map(s=>`<div class="stat-card"><div style="display:flex;justify-content:space-between;margin-bottom:8px"><span style="font-size:12px;color:var(--text3)">${s[0]}</span></div><div style="font-size:20px;font-weight:800;color:var(--text)">${s[1]}</div>${s[2]}</div>`).join('')}
  </div>`;

  // Charts
  const chartData30 = hist.slice(-30);
  html += `<div class="charts-grid">
    <div class="chart-card"><div class="chart-header"><div><div class="chart-title">üìà –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div><div class="chart-value">${fmtFull(hist[hist.length-1].subscribers)}</div></div></div><div class="chart-body">${makeChart(chartData30,'subscribers','#8b5cf6','subG','',220)}<div class="chart-dates"><span>${chartData30[0].date}</span><span>${chartData30[chartData30.length-1].date}</span></div></div></div>
    <div class="chart-card"><div class="chart-header"><div><div class="chart-title">üëÅ –ü—Ä–æ—Å–º–æ—Ç—Ä—ã –ø–æ –¥–Ω—è–º</div><div class="chart-value">${fmt(hist[hist.length-1].views)}</div></div></div><div class="chart-body">${makeChart(chartData30,'views','#10b981','viewG','',220)}<div class="chart-dates"><span>${chartData30[0].date}</span><span>${chartData30[chartData30.length-1].date}</span></div></div></div>
  </div>`;
  html += `<div class="chart-card" style="margin-bottom:24px"><div class="chart-header"><div><div class="chart-title">üöÄ –ü—Ä–∏—Ä–æ—Å—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –ø–æ –¥–Ω—è–º</div></div></div><div class="chart-body">${makeChart(chartData30,'growth','#f59e0b','growG','',200)}<div class="chart-dates"><span>${chartData30[0].date}</span><span>${chartData30[chartData30.length-1].date}</span></div></div></div>`;

  // Table
  html += `<div class="card" style="margin-bottom:24px"><div style="padding:16px 20px;border-bottom:1px solid var(--border2)"><span style="font-size:14px;font-weight:700;color:var(--text)">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–Ω—è–º (14 –¥–Ω–µ–π)</span></div><div class="table-scroll"><table class="data-table"><thead><tr><th>–î–∞—Ç–∞</th><th class="right">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</th><th class="right">–ü—Ä–∏—Ä–æ—Å—Ç</th><th class="right">–ü—Ä–æ—Å–º–æ—Ç—Ä—ã</th></tr></thead><tbody>${hist.slice(-14).reverse().map((d,i)=>`<tr class="${i===0?'today':''}"><td>${new Date(d.date).toLocaleDateString('ru-RU',{day:'numeric',month:'short'})}${i===0?'<span class="today-badge">—Å–µ–≥–æ–¥–Ω—è</span>':''}</td><td class="right" style="font-weight:600;color:var(--text)">${fmtFull(d.subscribers)}</td><td class="right" style="color:var(--emerald);font-weight:600">+${fmtFull(d.growth)}</td><td class="right" style="color:var(--text2)">${fmtFull(d.views)}</td></tr>`).join('')}</tbody></table></div></div>`;

  // Related
  if(related.length) {
    html += `<div class="related-section"><div class="related-title">–ü–æ—Ö–æ–∂–∏–µ –∫–∞–Ω–∞–ª—ã –≤ ¬´${getCat(ch.category)}¬ª</div><div class="channel-grid">${related.map((c,i)=>renderChannelCard(c,i+1)).join('')}</div></div>`;
  }
  html += '</div>';
  return html;
}

function renderTopPage() {
  let sortBy=state.topSort;
  const sortTabs=[{k:'subscribers',l:'–ü–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º',i:icons.users},{k:'views',l:'–ü–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º',i:icons.eye},{k:'growthDay',l:'–ü–æ –ø—Ä–∏—Ä–æ—Å—Ç—É',i:icons.trending}];
  const sorted=[...channels].sort((a,b)=>b[sortBy]-a[sortBy]);
  const rankGrads = i => i===0?'grad-amber':i===1?'background:linear-gradient(135deg,#94a3b8,#64748b)':i===2?'grad-orange':'grad-violet';
  const rankStyles = i => i<3?[,'linear-gradient(135deg,#fbbf24,#d97706)','linear-gradient(135deg,#94a3b8,#64748b)','linear-gradient(135deg,#fb923c,#ea580c)'][i+1]:'linear-gradient(135deg,#8b5cf6,#7c3aed)';

  return `<div class="detail-bar"><div class="container"><div class="detail-bar-inner"><button class="back-btn" onclick="navigate('home')">${icons.back} –ù–∞–∑–∞–¥</button><div style="display:flex;align-items:center;gap:8px;font-size:13px;font-weight:600;color:var(--text)">${icons.crown} –¢–æ–ø –∫–∞–Ω–∞–ª–æ–≤ MAX</div></div></div></div>
  <div class="container main-content" style="padding-top:24px;max-width:960px">
    <div class="top-page-title"><h1>üèÜ –†–µ–π—Ç–∏–Ω–≥ –∫–∞–Ω–∞–ª–æ–≤ MAX</h1><p>–ü–æ–ª–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –≤—Å–µ—Ö –∫–∞–Ω–∞–ª–æ–≤ –ø–æ —Ä–∞–∑–Ω—ã–º –º–µ—Ç—Ä–∏–∫–∞–º</p></div>
    <div style="display:flex;justify-content:center;margin-bottom:24px"><div class="sort-pills">${sortTabs.map(t=>`<button class="sort-pill ${sortBy===t.k?'active':''}" onclick="state.topSort='${t.k}';render()">${t.i} ${t.l}</button>`).join('')}</div></div>
    <div class="card"><div class="table-scroll"><table class="data-table top-table"><thead><tr><th style="width:48px">#</th><th>–ö–∞–Ω–∞–ª</th><th class="right">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</th><th class="right">–ü—Ä–æ—Å–º–æ—Ç—Ä—ã</th><th class="right">–ü—Ä–∏—Ä–æ—Å—Ç/–¥</th><th class="right">ER</th></tr></thead><tbody>
    ${sorted.map((ch,i)=>`<tr class="${i<3?'gold':''}" style="cursor:pointer" onclick="navigate('channel',${ch.id})"><td><div class="top-table-rank" style="background:${rankStyles(i)}">${i+1}</div></td><td><div style="display:flex;align-items:center;gap:10px"><div class="top-table-avatar ${ch.avatar}">${ch.name[0]}</div><div><div style="display:flex;align-items:center;gap:4px"><span class="top-table-name">${ch.name}</span>${ch.verified?`<span style="color:var(--blue)">${icons.badge}</span>`:''}</div><div class="top-table-username">${ch.username}</div></div></div></td><td class="right" style="font-weight:700;color:var(--text)">${fmt(ch.subscribers)}<br><span style="font-size:10px;color:var(--text4)">${fmtFull(ch.subscribers)}</span></td><td class="right" style="color:var(--text2)">${fmt(ch.avgViews)}</td><td class="right" style="font-weight:700;color:var(--emerald)">+${fmt(ch.growthDay)}</td><td class="right"><span class="er-badge ${ch.er>=40?'high':ch.er>=37?'mid':'low'}">${ch.er}%</span></td></tr>`).join('')}
    </tbody></table></div></div></div>`;
}

function renderComparePage() {
  const chs = channels.filter(c=>state.compare.includes(c.id));
  if(!chs.length) return `<div class="detail-bar"><div class="container"><div class="detail-bar-inner"><button class="back-btn" onclick="navigate('home')">${icons.back} –ù–∞–∑–∞–¥</button><span style="font-size:13px;font-weight:600;color:var(--text)">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤</span></div></div></div><div class="fav-empty"><div style="text-align:center"><div class="fav-empty-icon" style="background:rgba(139,92,246,.1)">${icons.chart}</div><div class="empty-title">–ù–µ—Ç –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</div><div class="empty-desc">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–∞–Ω–∞–ª–∞</div><button class="primary-btn" onclick="navigate('home')">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫–∞—Ç–∞–ª–æ–≥—É</button></div></div>`;

  const metrics=[{k:'subscribers',l:'–ü–æ–¥–ø–∏—Å—á–∏–∫–∏',i:icons.users,f:v=>fmtFull(v)},{k:'avgViews',l:'–°—Ä. –ø—Ä–æ—Å–º–æ—Ç—Ä—ã',i:icons.eye,f:v=>fmt(v)},{k:'growthDay',l:'–ü—Ä–∏—Ä–æ—Å—Ç/–¥–µ–Ω—å',i:icons.trending,f:v=>'+'+fmt(v),g:true},{k:'growthWeek',l:'–ü—Ä–∏—Ä–æ—Å—Ç/–Ω–µ–¥–µ–ª—è',i:icons.trending,f:v=>'+'+fmt(v),g:true},{k:'growthMonth',l:'–ü—Ä–∏—Ä–æ—Å—Ç/–º–µ—Å—è—Ü',i:icons.chart,f:v=>'+'+fmt(v),g:true},{k:'er',l:'ER',i:icons.activity,f:v=>v+'%'},{k:'postsPerDay',l:'–ü–æ—Å—Ç–æ–≤/–¥–µ–Ω—å',i:icons.msg,f:v=>''+v},{k:'totalPosts',l:'–í—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤',i:icons.msg,f:v=>fmtFull(v)}];
  const best = k => Math.max(...chs.map(c=>c[k]));

  return `<div class="detail-bar"><div class="container"><div class="detail-bar-inner"><button class="back-btn" onclick="navigate('home')">${icons.back} –ù–∞–∑–∞–¥</button><span style="font-size:13px;font-weight:600;color:var(--text)">‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ (${chs.length})</span></div></div></div>
  <div class="container main-content" style="padding-top:24px"><h1 style="text-align:center;font-size:24px;font-weight:800;color:var(--text);margin-bottom:24px">‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤</h1>
  <div class="card"><div class="table-scroll"><table class="compare-table"><thead><tr><th style="text-align:left">–ú–µ—Ç—Ä–∏–∫–∞</th>${chs.map(ch=>`<th><div style="display:flex;flex-direction:column;align-items:center;gap:8px"><div class="compare-avatar ${ch.avatar}" onclick="navigate('channel',${ch.id})">${ch.name[0]}<button class="compare-remove" onclick="event.stopPropagation();toggleCompare(${ch.id})">√ó</button></div><span style="font-size:12px;font-weight:600;color:var(--text);cursor:pointer" onclick="navigate('channel',${ch.id})">${ch.name}</span></div></th>`).join('')}</tr></thead><tbody>
  <tr><td style="font-size:13px;font-weight:500;color:var(--text2)">üìà –ì—Ä–∞—Ñ–∏–∫</td>${chs.map(ch=>`<td><div style="display:flex;justify-content:center">${makeSvgSpark(ch.history,'subscribers','#8b5cf6',120,40)}</div></td>`).join('')}</tr>
  ${metrics.map(m=>{const b=best(m.k);return `<tr><td><div class="metric-cell">${m.i}<span style="font-size:13px;font-weight:500;color:var(--text2)">${m.l}</span></div></td>${chs.map(ch=>{const v=ch[m.k];const isB=v===b&&chs.length>1;return `<td><span style="font-size:13px;font-weight:700;color:${isB?'var(--emerald)':m.g?'var(--violet)':'var(--text)'}">${m.f(v)}</span>${isB?'<span class="best-badge">–ª—É—á—à–∏–π</span>':''}</td>`;}).join('')}</tr>`;}).join('')}
  </tbody></table></div></div></div>`;
}

function renderFavoritesPage() {
  const chs = channels.filter(c=>state.favs.includes(c.id));
  if(!chs.length) return `<div class="detail-bar"><div class="container"><div class="detail-bar-inner"><button class="back-btn" onclick="navigate('home')">${icons.back} –ù–∞–∑–∞–¥</button><span style="font-size:13px;font-weight:600;color:var(--text)">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span></div></div></div><div class="fav-empty"><div style="text-align:center"><div class="fav-empty-icon" style="background:rgba(236,72,153,.1);color:var(--pink)">${icons.heartFill}</div><div class="empty-title">–ù–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</div><div class="empty-desc">–ù–∞–∂–º–∏—Ç–µ ‚ù§Ô∏è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –∫–∞–Ω–∞–ª–∞, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</div><button class="primary-btn" onclick="navigate('home')">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫–∞—Ç–∞–ª–æ–≥—É</button></div></div>`;

  return `<div class="detail-bar"><div class="container"><div class="detail-bar-inner"><button class="back-btn" onclick="navigate('home')">${icons.back} –ù–∞–∑–∞–¥</button><span style="font-size:13px;font-weight:600;color:var(--text)">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ (${chs.length})</span></div></div></div>
  <div class="container main-content" style="padding-top:24px;max-width:960px"><h1 style="text-align:center;font-size:24px;font-weight:800;color:var(--text);margin-bottom:24px">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã</h1>
  <div class="channel-grid">${chs.map((c,i)=>renderChannelCard(c,i+1)).join('')}</div></div>`;
}

function renderFooter() {
  return `<footer class="footer"><div class="container"><div class="footer-inner">
    <div class="footer-brand"><div class="logo" onclick="navigate('home')">${logoSvg}<div><span style="font-weight:800;color:var(--text)"><span style="background:linear-gradient(135deg,#8b5cf6,#3b82f6);-webkit-background-clip:text;-webkit-text-fill-color:transparent">Max</span>Metric</span><div style="font-size:11px;color:var(--text4)">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ MAX</div></div></div><p>–°–∞–º—ã–π –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∫–∞–Ω–∞–ª–æ–≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ MAX. –†–µ–π—Ç–∏–Ω–≥–∏, –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–æ—Å—Ç–∞, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤.</p><div style="display:flex;gap:8px;margin-top:12px"><span style="font-size:10px;padding:3px 8px;border-radius:10px;background:rgba(16,185,129,.1);color:var(--emerald);font-weight:600">üü¢ Online</span><span style="font-size:10px;padding:3px 8px;border-radius:10px;background:var(--bg3);color:var(--text4)">v2.0</span></div></div>
    <div class="footer-col"><h4>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h4>${categories.filter(c=>c.id!=='all').slice(0,7).map(c=>`<button onclick="navigate('category','${c.id}')">${c.icon} ${c.name}</button>`).join('')}</div>
    <div class="footer-col"><h4>–ï—â—ë –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h4>${categories.filter(c=>c.id!=='all').slice(7).map(c=>`<button onclick="navigate('category','${c.id}')">${c.icon} ${c.name}</button>`).join('')}</div>
    <div class="footer-col"><h4>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h4><button onclick="navigate('top','subscribers')">üèÜ –†–µ–π—Ç–∏–Ω–≥ –∫–∞–Ω–∞–ª–æ–≤</button><button onclick="navigate('top','views')">üëÅ –¢–æ–ø –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º</button><button onclick="navigate('top','growthDay')">üìà –¢–æ–ø –ø–æ –ø—Ä–∏—Ä–æ—Å—Ç—É</button><button onclick="navigate('compare')">‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤</button><button onclick="navigate('favorites')">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</button></div>
  </div><div class="footer-bottom"><span>¬© 2025 MaxMetric. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</span><span>–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å ‚Ä¢ ${channels.length} –∫–∞–Ω–∞–ª–æ–≤ –≤ –±–∞–∑–µ</span></div></div></footer>`;
}

function renderBottomNav() {
  return `<div class="bottom-nav">
    <button class="bnav-btn" onclick="navigate('home')">${icons.home}<span>–ì–ª–∞–≤–Ω–∞—è</span></button>
    <button class="bnav-btn" onclick="navigate('top','subscribers')">${icons.trending}<span>–†–µ–π—Ç–∏–Ω–≥</span></button>
    <button class="bnav-center" onclick="state.showModal=true;render()">${icons.plus}</button>
    <button class="bnav-btn" onclick="navigate('favorites')">${icons.heart}<span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>${state.favs.length?`<span class="bnav-badge" style="background:var(--pink)">${state.favs.length}</span>`:''}</button>
    <button class="bnav-btn" onclick="${currentUser?`navigate('profile')`:`state.showAuthModal=true;state.authTab='login';state.authError='';render()`}" style="${state.page==='profile'?'color:var(--violet)':''}">
      ${currentUser ? `<div style="width:20px;height:20px;border-radius:6px;background:linear-gradient(135deg,#8b5cf6,#3b82f6);display:flex;align-items:center;justify-content:center;color:#fff;font-size:9px;font-weight:700">${currentUser.name[0].toUpperCase()}</div>` : icons.user}
      <span>${currentUser?'–ü—Ä–æ—Ñ–∏–ª—å':'–í–æ–π—Ç–∏'}</span>
    </button>
  </div>`;
}

function renderAddModal() {
  return `<div class="modal-overlay" onclick="state.showModal=false;render()"><div class="modal-backdrop"></div><div class="modal-content" onclick="event.stopPropagation()"><div class="modal-bar"></div><div class="modal-body" id="modal-body">
    <div class="modal-header"><div><div class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª</div><div class="modal-subtitle">–û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤–∞—à –∫–∞–Ω–∞–ª –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é</div></div><button class="icon-btn" onclick="state.showModal=false;render()">${icons.x}</button></div>
    <form onsubmit="handleAddSubmit(event)">
      <div class="form-group"><label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ <span class="req">*</span></label><input class="form-input" name="name" placeholder="MAX –ù–æ–≤–æ—Å—Ç–∏" required /></div>
      <div class="form-group"><label class="form-label">–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª <span class="req">*</span></label><input class="form-input" name="url" placeholder="https://max.me/mychannel" required /></div>
      <div class="form-group"><label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è <span class="req">*</span></label><select class="form-select" name="category" required><option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>${categories.filter(c=>c.id!=='all').map(c=>`<option value="${c.id}">${c.icon} ${c.name}</option>`).join('')}</select></div>
      <div class="form-group"><label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ <span class="req">*</span></label><textarea class="form-textarea" name="description" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–º –∫–∞–Ω–∞–ª–µ –ø–æ–¥—Ä–æ–±–Ω–æ..." required minlength="20"></textarea></div>
      <div class="form-note">üìã –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏ –Ω–∞—à–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã –ø—Ä–æ–≤–µ—Ä—è—Ç –∫–∞–Ω–∞–ª –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º –∫–∞—Ç–∞–ª–æ–≥–∞. –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ–±—ã—á–Ω–æ –∑–∞–Ω–∏–º–∞–µ—Ç 1-2 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è.</div>
      <button type="submit" class="submit-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é</button>
    </form>
  </div></div></div>`;
}

function handleAddSubmit(e) {
  e.preventDefault();
  const body = document.getElementById('modal-body');
  body.innerHTML = `<div class="success-state"><div class="success-icon grad-emerald" style="color:#fff">${icons.check}</div><div class="empty-title">–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!</div><div class="empty-desc">–í–∞—à –∫–∞–Ω–∞–ª –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º–∏</div><div style="font-size:12px;color:var(--text4)">–û–±—ã—á–Ω–æ –º–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç 1-2 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è</div><div class="progress-bar"><div class="progress-fill"></div></div></div>`;
  setTimeout(()=>{state.showModal=false;render();},2500);
}

function renderShareModal() {
  return `<div class="modal-overlay" onclick="state.showShare=false;render()"><div class="modal-backdrop"></div><div class="modal-content" style="max-width:400px" onclick="event.stopPropagation()"><div class="modal-bar"></div><div class="modal-body">
    <div class="modal-header"><div class="modal-title">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</div><button class="icon-btn" onclick="state.showShare=false;render()">${icons.x}</button></div>
    <div class="share-link-row"><input type="text" readonly value="${state.shareLink}" id="share-input" /><button class="share-copy-btn" id="share-copy" onclick="copyShareLink()">${icons.copy}</button></div>
    <div id="copy-feedback"></div>
  </div></div></div>`;
}

function copyShareLink() {
  const input = document.getElementById('share-input');
  if(input) { navigator.clipboard.writeText(input.value).catch(()=>{}); }
  const btn = document.getElementById('share-copy');
  if(btn){btn.className='share-copy-btn copied';btn.innerHTML=icons.check;}
  const fb = document.getElementById('copy-feedback');
  if(fb){fb.innerHTML='<div class="copy-msg">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>';}
  setTimeout(()=>{if(btn){btn.className='share-copy-btn';btn.innerHTML=icons.copy;}if(fb)fb.innerHTML='';},2000);
}

// ========== AUTH MODAL ==========
function renderAuthModal() {
  const isLogin = state.authTab === 'login';
  return `<div class="modal-overlay" onclick="state.showAuthModal=false;render()"><div class="modal-backdrop"></div><div class="modal-content" style="max-width:420px" onclick="event.stopPropagation()"><div class="modal-bar"></div><div class="modal-body">
    <div class="modal-header"><div><div class="modal-title">${isLogin?'–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å':'–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç'}</div><div class="modal-subtitle">${isLogin?'–í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç MaxMetric':'–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ'}</div></div><button class="icon-btn" onclick="state.showAuthModal=false;render()">${icons.x}</button></div>
    <div class="auth-tabs"><button class="auth-tab ${isLogin?'active':''}" onclick="state.authTab='login';state.authError='';render()">–í—Ö–æ–¥</button><button class="auth-tab ${!isLogin?'active':''}" onclick="state.authTab='register';state.authError='';render()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button></div>
    ${state.authError ? `<div style="padding:10px 14px;border-radius:12px;background:rgba(239,68,68,.08);border:1px solid rgba(239,68,68,.2);color:var(--red);font-size:13px;margin-bottom:14px;display:flex;align-items:center;gap:8px">‚ö†Ô∏è ${state.authError}</div>` : ''}
    <form id="auth-form" onsubmit="handleAuthSubmit(event)">
      ${!isLogin ? `<div class="form-group"><label class="form-label">–ò–º—è <span class="req">*</span></label><div class="auth-input-wrap">${icons.user}<input class="form-input" name="name" placeholder="–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?" required minlength="2" /></div></div>` : ''}
      <div class="form-group"><label class="form-label">Email <span class="req">*</span></label><div class="auth-input-wrap"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg><input class="form-input" name="email" type="email" placeholder="example@mail.ru" required /></div></div>
      <div class="form-group"><label class="form-label">–ü–∞—Ä–æ–ª—å <span class="req">*</span></label><div class="auth-input-wrap"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg><input class="form-input" name="password" type="${state.authShowPass?'text':'password'}" placeholder="${isLogin?'–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å':'–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤'}" required minlength="6" /><button type="button" class="eye-btn" onclick="state.authShowPass=!state.authShowPass;render()">${state.authShowPass?'<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>':'<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>'}</button></div></div>
      ${!isLogin ? `<div class="form-group"><label class="form-label">–ü–æ–≤—Ç–æ—Ä –ø–∞—Ä–æ–ª—è <span class="req">*</span></label><div class="auth-input-wrap"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg><input class="form-input" name="password2" type="password" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required minlength="6" /></div></div>` : ''}
      <button type="submit" class="submit-btn" style="margin-top:4px">${isLogin?'–í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç':'–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç'}</button>
    </form>
    <div class="auth-divider"><span>–∏–ª–∏</span></div>
    <button class="auth-social-btn" onclick="handleDemoLogin()">üë§ –í–æ–π—Ç–∏ –∫–∞–∫ –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</button>
    <p style="text-align:center;font-size:12px;color:var(--text4);margin-top:12px">${isLogin?'–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞?':'–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?'} <button style="color:var(--violet);font-weight:600" onclick="state.authTab='${isLogin?'register':'login'}';state.authError='';render()">${isLogin?'–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è':'–í–æ–π—Ç–∏'}</button></p>
  </div></div></div>`;
}

function handleDemoLogin() {
  // Create or find demo user
  let demo = authUsers.find(u=>u.email==='demo@maxmetric.ru');
  if(!demo) {
    authRegister('–î–µ–º–æ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å','demo@maxmetric.ru','demo12345');
  } else {
    authLogin('demo@maxmetric.ru','demo12345');
  }
  state.showAuthModal=false;
  state.page='profile';
  render();
}

function handleAuthSubmit(e) {
  e.preventDefault();
  const f = e.target;
  const isLogin = state.authTab==='login';
  const email = f.email.value.trim();
  const password = f.password.value;
  if(!isLogin) {
    const name = f.name.value.trim();
    const p2 = f.password2.value;
    if(password !== p2) { state.authError='–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç'; render(); return; }
    const r = authRegister(name, email, password);
    if(!r.ok) { state.authError=r.err; render(); return; }
  } else {
    const r = authLogin(email, password);
    if(!r.ok) { state.authError=r.err; render(); return; }
  }
  state.showAuthModal=false;
  state.authError='';
  state.page='profile';
  render();
}

// ========== PROFILE PAGE ==========
function renderProfilePage() {
  if(!currentUser) { navigate('home'); return ''; }
  const myFavs = state.favs.length;
  const myCmp = state.compare.length;
  const myRecent = state.recent.length;
  const joinDate = new Date(currentUser.createdAt).toLocaleDateString('ru-RU',{year:'numeric',month:'long',day:'numeric'});
  const favChannels = channels.filter(c=>state.favs.includes(c.id)).slice(0,4);
  const recentChannels = state.recent.map(id=>channels.find(c=>c.id===id)).filter(Boolean).slice(0,4);
  
  const avatarGrad = currentUser.avatar || 'grad-violet';

  return `<div class="detail-bar"><div class="container"><div class="detail-bar-inner">
    <button class="back-btn" onclick="navigate('home')">${icons.back} –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–∞–ª–æ–≥—É</button>
    <div style="display:flex;align-items:center;gap:8px;font-size:13px;font-weight:600;color:var(--text)">${icons.user} –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</div>
  </div></div></div>
  <div class="container main-content" style="padding-top:24px;max-width:900px">

    <!-- Hero card -->
    <div class="profile-hero card">
      <div class="profile-hero-bg"><div class="profile-hero-pattern"></div>
        <div style="position:absolute;top:12px;right:16px;display:flex;gap:8px">
          <button onclick="navigate('home')" style="padding:7px 14px;border-radius:10px;background:rgba(255,255,255,.15);color:#fff;font-size:12px;font-weight:600;border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(8px)">‚Üê –ö–∞—Ç–∞–ª–æ–≥</button>
          <button onclick="doLogout()" style="padding:7px 14px;border-radius:10px;background:rgba(239,68,68,.2);color:#fff;font-size:12px;font-weight:600;border:1px solid rgba(239,68,68,.3);backdrop-filter:blur(8px)">${icons.logout} –í—ã–π—Ç–∏</button>
        </div>
      </div>
      <div class="profile-avatar-wrap"><div class="profile-big-avatar ${avatarGrad}">${currentUser.name[0].toUpperCase()}</div></div>
      <div class="profile-info">
        <div class="profile-name">${currentUser.name}</div>
        <div class="profile-email"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>${currentUser.email}</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
          <span class="profile-badge" style="background:rgba(139,92,246,.1);color:var(--violet)">‚ú® ${currentUser.plan}</span>
          <span class="profile-badge" style="background:rgba(16,185,129,.08);color:var(--emerald)">${icons.calendar} –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ${joinDate}</span>
        </div>
      </div>
    </div>

    <!-- Stats -->
    <div class="profile-stats-row">
      <div class="profile-stat-card" onclick="navigate('favorites')">
        <div class="profile-stat-num" style="color:var(--pink)">${myFavs}</div>
        <div class="profile-stat-label">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</div>
      </div>
      <div class="profile-stat-card" onclick="navigate('compare')">
        <div class="profile-stat-num" style="color:var(--violet)">${myCmp}</div>
        <div class="profile-stat-label">‚öñÔ∏è –í —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏</div>
      </div>
      <div class="profile-stat-card">
        <div class="profile-stat-num" style="color:var(--blue)">${myRecent}</div>
        <div class="profile-stat-label">üëÅ –ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ –∫–∞–Ω–∞–ª–æ–≤</div>
      </div>
    </div>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px">
    <!-- Fav channels -->
    <div class="profile-section">
      <div class="profile-section-header">
        <span class="profile-section-title">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã</span>
        ${myFavs>0?`<button onclick="navigate('favorites')" style="font-size:12px;color:var(--violet)">–í—Å–µ ‚Üí</button>`:''}
      </div>
      <div class="profile-section-body">
        ${favChannels.length ? favChannels.map(ch=>`<div onclick="navigate('channel',${ch.id})" style="display:flex;align-items:center;gap:10px;padding:8px;border-radius:10px;cursor:pointer;transition:background .15s" onmouseover="this.style.background='var(--bg3)'" onmouseout="this.style.background='transparent'">
          <div class="${ch.avatar}" style="width:32px;height:32px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px;font-weight:700;flex-shrink:0">${ch.name[0]}</div>
          <div style="flex:1;min-width:0"><div style="font-size:13px;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${ch.name}</div><div style="font-size:10px;color:var(--text4)">${fmt(ch.subscribers)} –ø–æ–¥–ø.</div></div>
          <div style="font-size:11px;color:var(--emerald);font-weight:600">+${fmt(ch.growthDay)}</div>
        </div>`).join('') : `<div style="text-align:center;padding:20px;color:var(--text4);font-size:13px">–ù–µ—Ç –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤<br><button onclick="navigate('home')" style="color:var(--violet);font-size:12px;margin-top:8px">–î–æ–±–∞–≤–∏—Ç—å ‚Üí</button></div>`}
      </div>
    </div>

    <!-- Recently viewed -->
    <div class="profile-section">
      <div class="profile-section-header">
        <span class="profile-section-title">üïê –ù–µ–¥–∞–≤–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ</span>
      </div>
      <div class="profile-section-body">
        ${recentChannels.length ? recentChannels.map(ch=>`<div onclick="navigate('channel',${ch.id})" style="display:flex;align-items:center;gap:10px;padding:8px;border-radius:10px;cursor:pointer;transition:background .15s" onmouseover="this.style.background='var(--bg3)'" onmouseout="this.style.background='transparent'">
          <div class="${ch.avatar}" style="width:32px;height:32px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px;font-weight:700;flex-shrink:0">${ch.name[0]}</div>
          <div style="flex:1;min-width:0"><div style="font-size:13px;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${ch.name}</div><div style="font-size:10px;color:var(--text4)">${ch.username}</div></div>
        </div>`).join('') : `<div style="text-align:center;padding:20px;color:var(--text4);font-size:13px">–ù–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö<br><button onclick="navigate('home')" style="color:var(--violet);font-size:12px;margin-top:8px">–ö –∫–∞—Ç–∞–ª–æ–≥—É ‚Üí</button></div>`}
      </div>
    </div>
    </div>

    <!-- Settings -->
    <div class="profile-section" id="settings-section">
      <div class="profile-section-header">
        <span class="profile-section-title">${icons.settings} –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞</span>
      </div>
      <div class="profile-section-body">
        <form onsubmit="handleSaveSettings(event)">
          <div class="settings-row" style="margin-bottom:12px">
            <div class="form-group" style="margin-bottom:0"><label class="form-label">–ò–º—è</label><input class="form-input" name="name" value="${currentUser.name}" required /></div>
            <div class="form-group" style="margin-bottom:0"><label class="form-label">Email</label><input class="form-input" name="email" type="email" value="${currentUser.email}" required /></div>
          </div>
          <div class="settings-row" style="margin-bottom:16px">
            <div class="form-group" style="margin-bottom:0"><label class="form-label">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label><input class="form-input" name="newpass" type="password" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å" /></div>
            <div class="form-group" style="margin-bottom:0"><label class="form-label">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</label><input class="form-input" name="newpass2" type="password" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" /></div>
          </div>
          <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px">
            <button type="submit" class="settings-save-btn">${icons.check} –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            <div id="settings-msg" style="font-size:12px;color:var(--emerald)"></div>
          </div>
        </form>
      </div>
    </div>

    <!-- Appearance -->
    <div class="profile-section">
      <div class="profile-section-header">
        <span class="profile-section-title">üé® –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</span>
      </div>
      <div class="profile-section-body">
        <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px">
          <div>
            <div style="font-size:13px;font-weight:600;color:var(--text);margin-bottom:3px">–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</div>
            <div style="font-size:12px;color:var(--text4)">–¢–µ–∫—É—â–∞—è: ${state.theme==='dark'?'üåô –¢—ë–º–Ω–∞—è':'‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è'}</div>
          </div>
          <button onclick="state.theme=state.theme==='dark'?'light':'dark';render()" style="display:flex;align-items:center;gap:8px;padding:10px 20px;border-radius:12px;background:var(--bg3);border:1px solid var(--border);font-size:13px;font-weight:600;color:var(--text2);transition:all .2s">${state.theme==='dark'?icons.sun:icons.moon} ${state.theme==='dark'?'–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Å–≤–µ—Ç–ª—É—é':'–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ç—ë–º–Ω—É—é'}</button>
        </div>
        <div style="margin-top:14px;padding-top:14px;border-top:1px solid var(--border2)">
          <div style="font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.6px;color:var(--text4);margin-bottom:10px">–¶–≤–µ—Ç –∞–≤–∞—Ç–∞—Ä–∞</div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            ${['grad-violet','grad-blue','grad-emerald','grad-amber','grad-pink','grad-indigo','grad-teal','grad-orange'].map(g=>`<button onclick="setAvatarColor('${g}')" style="width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:14px;font-weight:700;transition:all .2s;${currentUser.avatar===g?'box-shadow:0 0 0 3px var(--violet),0 0 0 5px var(--bg)':'opacity:.7'}" class="${g}">${currentUser.name[0].toUpperCase()}</button>`).join('')}
          </div>
        </div>
      </div>
    </div>

    <!-- Danger zone -->
    <div class="profile-section">
      <div class="profile-section-header">
        <span class="profile-section-title" style="color:var(--red)">‚ö†Ô∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</span>
      </div>
      <div class="profile-section-body" style="display:flex;gap:10px;flex-wrap:wrap">
        <button class="danger-btn" onclick="clearData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
        <button class="danger-btn" onclick="deleteAccount()">‚ùå –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
      </div>
    </div>

  </div>`;
}

function setAvatarColor(grad) {
  if(!currentUser) return;
  currentUser.avatar = grad;
  const idx = authUsers.findIndex(u=>u.id===currentUser.id);
  if(idx>=0) authUsers[idx] = currentUser;
  saveUsers(); saveCurrentUser(); render();
}

function handleSaveSettings(e) {
  e.preventDefault();
  const f = e.target;
  const name = f.name.value.trim();
  const email = f.email.value.trim();
  const newpass = f.newpass.value;
  const newpass2 = f.newpass2.value;
  if(newpass && newpass !== newpass2) { alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç'); return; }
  if(email !== currentUser.email && authUsers.find(u=>u.email===email && u.id!==currentUser.id)) { alert('–¢–∞–∫–æ–π email —É–∂–µ –∑–∞–Ω—è—Ç'); return; }
  currentUser.name = name;
  currentUser.email = email;
  if(newpass) currentUser.password = btoa(newpass);
  const idx = authUsers.findIndex(u=>u.id===currentUser.id);
  if(idx>=0) authUsers[idx] = currentUser;
  saveUsers(); saveCurrentUser();
  const msg = document.getElementById('settings-msg');
  if(msg) { msg.textContent = '‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!'; setTimeout(()=>{msg.textContent='';},2000); }
  render();
}

function doLogout() {
  authLogout();
  state.page='home';
  render();
}

function clearData() {
  if(!confirm('–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ?')) return;
  state.favs=[]; state.compare=[]; state.recent=[];
  saveFavs(); saveRecent(); render();
}

function deleteAccount() {
  if(!confirm('–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.')) return;
  authUsers = authUsers.filter(u=>u.id!==currentUser.id);
  saveUsers();
  authLogout();
  state.page='home';
  render();
}

function bindEvents() {
  // No dropdowns to close now (profile is a full page)
  // Init ad slider on every render (only if on home page)
  requestAnimationFrame(() => {
    if(document.getElementById('ad-track')) {
      if(adSliderTimer) clearInterval(adSliderTimer);
      adSliderTimer = null;
      adSliderInit();
    }
  });
}


// ========== AD SLIDER LOGIC ==========
let adSliderIndex = 0;
let adSliderTotal = 6;
let adSliderTimer = null;
let adSliderVisible = 4; // cards visible

function adGetVisible() {
  if(window.innerWidth < 480) return 1;
  if(window.innerWidth < 768) return 2;
  return 4;
}

function adSliderGoTo(idx) {
  adSliderVisible = adGetVisible();
  const maxIdx = adSliderTotal - adSliderVisible;
  adSliderIndex = Math.max(0, Math.min(idx, maxIdx));
  const track = document.getElementById('ad-track');
  const wrap = document.getElementById('ad-wrap');
  if(!track || !wrap) return;
  const cards = track.querySelectorAll('.ad-card');
  if(!cards.length) return;
  const gap = 12;
  const wrapW = wrap.offsetWidth;
  const cardW = (wrapW - gap * (adSliderVisible - 1)) / adSliderVisible;
  const offset = adSliderIndex * (cardW + gap);
  track.style.transform = `translateX(-${offset}px)`;
  // Update dots
  document.querySelectorAll('.ad-dot').forEach((d,i) => {
    d.classList.toggle('active', i === adSliderIndex);
  });
  // Nav visibility
  const prev = document.getElementById('ad-prev');
  const next = document.getElementById('ad-next');
  if(prev) prev.style.opacity = adSliderIndex <= 0 ? '0.3' : '1';
  if(next) next.style.opacity = adSliderIndex >= maxIdx ? '0.3' : '1';
}

function adSliderNext() {
  adSliderVisible = adGetVisible();
  const maxIdx = adSliderTotal - adSliderVisible;
  adSliderGoTo(adSliderIndex >= maxIdx ? 0 : adSliderIndex + 1);
  adResetTimer();
}

function adSliderPrev() {
  adSliderVisible = adGetVisible();
  const maxIdx = adSliderTotal - adSliderVisible;
  adSliderGoTo(adSliderIndex <= 0 ? maxIdx : adSliderIndex - 1);
  adResetTimer();
}

function adStartTimer() {
  adSliderTimer = setInterval(() => {
    adSliderVisible = adGetVisible();
    const maxIdx = adSliderTotal - adSliderVisible;
    adSliderGoTo(adSliderIndex >= maxIdx ? 0 : adSliderIndex + 1);
  }, 5000);
}

function adResetTimer() {
  if(adSliderTimer) clearInterval(adSliderTimer);
  adStartTimer();
}

function adSliderInit() {
  const track = document.getElementById('ad-track');
  if(!track) return;
  adSliderVisible = adGetVisible();
  adSliderIndex = 0;
  // Fix card widths inline
  const wrap = document.getElementById('ad-wrap');
  if(wrap) {
    const gap = 12;
    const wrapW = wrap.offsetWidth;
    const cardW = (wrapW - gap * (adSliderVisible - 1)) / adSliderVisible;
    track.querySelectorAll('.ad-card').forEach(c => {
      c.style.flex = `0 0 ${cardW}px`;
      c.style.minWidth = `${cardW}px`;
    });
  }
  adSliderGoTo(0);
  adResetTimer();
  // Pause on hover (desktop)
  if(wrap) {
    wrap.addEventListener('mouseenter', () => { if(adSliderTimer) clearInterval(adSliderTimer); });
    wrap.addEventListener('mouseleave', () => adStartTimer());
  }
  // Touch swipe support
  if(wrap && !wrap._touchBound) {
    wrap._touchBound = true;
    let tx0 = 0;
    wrap.addEventListener('touchstart', e => { tx0 = e.touches[0].clientX; }, {passive:true});
    wrap.addEventListener('touchend', e => {
      const dx = e.changedTouches[0].clientX - tx0;
      if(Math.abs(dx) > 40) { dx < 0 ? adSliderNext() : adSliderPrev(); }
    }, {passive:true});
  }
}

// Init
render();
</script>
</body>
</html>
